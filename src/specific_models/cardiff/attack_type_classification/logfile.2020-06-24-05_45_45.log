Dataframe shape (lines, collumns): (220785, 136) 

First 5 entries:
    packet_id     num  ...  class_is_malicious  class_attack_type
0  1230361.0    98.0  ...                b'0'             b'N/A'
1  1131523.0    66.0  ...                b'0'             b'N/A'
2    63682.0  1294.0  ...                b'0'             b'N/A'
3    64788.0    95.0  ...                b'0'             b'N/A'
4    78512.0    60.0  ...                b'0'             b'N/A'

[5 rows x 136 columns] 

Decoding byte strings into ordinary strings.
Done.

Dataframe shape (lines, collumns): (220785, 136) 

First 5 entries:
    packet_id     num  ...  class_is_malicious  class_attack_type
0  1230361.0    98.0  ...                   0                N/A
1  1131523.0    66.0  ...                   0                N/A
2    63682.0  1294.0  ...                   0                N/A
3    64788.0    95.0  ...                   0                N/A
4    78512.0    60.0  ...                   0                N/A

[5 rows x 136 columns] 

<class 'pandas.core.frame.DataFrame'>
RangeIndex: 220785 entries, 0 to 220784
Columns: 136 entries, packet_id to class_attack_type
dtypes: float64(112), object(24)
memory usage: 229.1+ MB
Dataframe contains NaN values: True
Number of NaN columns: 94
Label types: ['N/A' 'DoS' 'iot-toolkit' 'MITM' 'Scanning']
Label distribution:
 N/A            110390
Scanning        51479
DoS             41236
MITM             9085
iot-toolkit      8595
Name: class_attack_type, dtype: int64


Column | # of different values
packet_id                       178077
num                                522
len                                522
caplen                             522
timestamp                       201487
frame.encap_type                     1
frame.offset_shift                   1
frame.time_epoch                201487
frame.time_delta                 69342
frame.time_delta_displayed       69342
frame.time_relative             201065
frame.number                     10031
frame.len                          522
frame.cap_len                      522
frame.marked                         1
frame.ignored                        1
eth.lg                               1
eth.ig                               1
ip.version                           1
ip.hdr_len                           2
ip.dsfield.dscp                      7
ip.dsfield.ecn                       1
ip.src                               0
ip.dst                               0
ip.len                             512
ip.flags                             5
ip.flags.rb                          1
ip.flags.df                          2
ip.flags.mf                          2
ip.frag_offset                     190
ip.ttl                              61
ip.proto                             4
ip.checksum.status                   1
tcp.srcport                       6193
tcp.dstport                      11090
tcp.stream                        2911
tcp.len                            455
tcp.seq                          12394
tcp.nxtseq                        9772
tcp.ack                          11649
tcp.hdr_len                          6
tcp.flags.res                        1
tcp.flags.ns                         1
tcp.flags.cwr                        2
tcp.flags.ecn                        2
tcp.flags.urg                        2
tcp.flags.ack                        2
tcp.flags.push                       2
tcp.flags.reset                      2
tcp.flags.syn                        2
tcp.flags.fin                        2
tcp.window_size_value              666
tcp.window_size                    764
tcp.window_size_scalefactor         10
tcp.checksum.status                  1
tcp.urgent_pointer                   1
tcp.options.nop                      1
tcp.options.timestamp.tsval      32898
tcp.options.timestamp.tsecr      29809
tcp.options.mss_val                  4
tcp.options.sack_perm                1
tcp.analysis.bytes_in_flight       908
tcp.analysis.push_bytes_sent       599
tcp.time_relative                    0
tcp.time_delta                       0
tcp.payload                        453
icmp.type                            4
icmp.code                            3
icmp.ident                        5139
icmp.checksum.status                 2
icmp.seq                          1657
icmp.seq_le                       1657
icmp.resp_in                         0
icmp.resp_to                      6321
data.len                           293
ssl.record.content_type              3
ssl.record.version                   2
ssl.record.length                  193
arp.hw.type                          1
arp.proto.type                       1
arp.hw.size                          1
arp.proto.size                       1
arp.opcode                           2
http.response.code                   2
http.content_length                  3
http.response                        1
http.response_number                 2
http.request                         1
http.request_number                  6
classicstun.type                     2
classicstun.length                   2
udp.srcport                       8539
udp.dstport                       2095
udp.length                          67
udp.checksum.status                  2
udp.stream                        1508
dns.flags.response                   2
dns.flags.opcode                     2
dns.flags.truncated                  2
dns.flags.recdesired                 2
dns.flags.z                          2
dns.flags.checkdisable               1
dns.flags.rcode                      1
dns.count.queries                    5
dns.count.answers                    9
dns.count.auth_rr                    5
dns.qry.name.len                    19
dns.count.labels                     6
dns.resp.type                        5
dns.resp.class                       1
dns.resp.ttl                       400
dns.resp.len                         9
igmp.version                         1
igmp.type                            1
igmp.max_resp                        1
igmp.checksum.status                 1
ntp.flags.li                         1
ntp.flags.vn                         2
ntp.flags.mode                       2
ntp.stratum                          4
ntp.ppoll                            2
ntp.rootdelay                      153
ntp.rootdispersion                 301
ntp.precision                       10
bootp.type                           3
bootp.hw.type                        1
bootp.hw.len                         2
bootp.hops                           2
bootp.secs                           5
bootp.flags.bc                       2
bootp.flags.reserved                 1
bootp.dhcp                           1
packet_type                          2
class_device_type                    7
class_is_malicious                   2
class_attack_type                    5
dtype: int64
Removing attributes that have only one sampled value.


Column | # of different values
packet_id                       178077
num                                522
len                                522
caplen                             522
timestamp                       201487
frame.time_epoch                201487
frame.time_delta                 69342
frame.time_delta_displayed       69342
frame.time_relative             201065
frame.number                     10031
frame.len                          522
frame.cap_len                      522
ip.hdr_len                           2
ip.dsfield.dscp                      7
ip.src                               0
ip.dst                               0
ip.len                             512
ip.flags                             5
ip.flags.df                          2
ip.flags.mf                          2
ip.frag_offset                     190
ip.ttl                              61
ip.proto                             4
tcp.srcport                       6193
tcp.dstport                      11090
tcp.stream                        2911
tcp.len                            455
tcp.seq                          12394
tcp.nxtseq                        9772
tcp.ack                          11649
tcp.hdr_len                          6
tcp.flags.cwr                        2
tcp.flags.ecn                        2
tcp.flags.urg                        2
tcp.flags.ack                        2
tcp.flags.push                       2
tcp.flags.reset                      2
tcp.flags.syn                        2
tcp.flags.fin                        2
tcp.window_size_value              666
tcp.window_size                    764
tcp.window_size_scalefactor         10
tcp.options.timestamp.tsval      32898
tcp.options.timestamp.tsecr      29809
tcp.options.mss_val                  4
tcp.analysis.bytes_in_flight       908
tcp.analysis.push_bytes_sent       599
tcp.time_relative                    0
tcp.time_delta                       0
tcp.payload                        453
icmp.type                            4
icmp.code                            3
icmp.ident                        5139
icmp.checksum.status                 2
icmp.seq                          1657
icmp.seq_le                       1657
icmp.resp_in                         0
icmp.resp_to                      6321
data.len                           293
ssl.record.content_type              3
ssl.record.version                   2
ssl.record.length                  193
arp.opcode                           2
http.response.code                   2
http.content_length                  3
http.response_number                 2
http.request_number                  6
classicstun.type                     2
classicstun.length                   2
udp.srcport                       8539
udp.dstport                       2095
udp.length                          67
udp.checksum.status                  2
udp.stream                        1508
dns.flags.response                   2
dns.flags.opcode                     2
dns.flags.truncated                  2
dns.flags.recdesired                 2
dns.flags.z                          2
dns.count.queries                    5
dns.count.answers                    9
dns.count.auth_rr                    5
dns.qry.name.len                    19
dns.count.labels                     6
dns.resp.type                        5
dns.resp.ttl                       400
dns.resp.len                         9
ntp.flags.vn                         2
ntp.flags.mode                       2
ntp.stratum                          4
ntp.ppoll                            2
ntp.rootdelay                      153
ntp.rootdispersion                 301
ntp.precision                       10
bootp.type                           3
bootp.hw.len                         2
bootp.hops                           2
bootp.secs                           5
bootp.flags.bc                       2
packet_type                          2
class_device_type                    7
class_is_malicious                   2
class_attack_type                    5
dtype: int64


Column | NaN values
packet_id                            0
num                                  0
len                                  0
caplen                               0
timestamp                            0
frame.time_epoch                     0
frame.time_delta                     0
frame.time_delta_displayed           0
frame.time_relative                  0
frame.number                         0
frame.len                            0
frame.cap_len                        0
ip.hdr_len                        7597
ip.dsfield.dscp                   7597
ip.src                          220785
ip.dst                          220785
ip.len                            7597
ip.flags                          7597
ip.flags.df                       7597
ip.flags.mf                       7597
ip.frag_offset                    7597
ip.ttl                            7597
ip.proto                          7597
tcp.srcport                      78568
tcp.dstport                      78568
tcp.stream                       90950
tcp.len                          90962
tcp.seq                          78571
tcp.nxtseq                      175345
tcp.ack                          90950
tcp.hdr_len                      90950
tcp.flags.cwr                    90950
tcp.flags.ecn                    90950
tcp.flags.urg                    90950
tcp.flags.ack                    90950
tcp.flags.push                   90950
tcp.flags.reset                  90950
tcp.flags.syn                    90950
tcp.flags.fin                    90950
tcp.window_size_value            90950
tcp.window_size                  90950
tcp.window_size_scalefactor     143979
tcp.options.timestamp.tsval     176694
tcp.options.timestamp.tsecr     176694
tcp.options.mss_val             169325
tcp.analysis.bytes_in_flight    175347
tcp.analysis.push_bytes_sent    175347
tcp.time_relative               220785
tcp.time_delta                  220785
tcp.payload                     176943
icmp.type                       185406
icmp.code                       185406
icmp.ident                      197833
icmp.checksum.status            185406
icmp.seq                        197833
icmp.seq_le                     197833
icmp.resp_in                    220785
icmp.resp_to                    209718
data.len                        146819
ssl.record.content_type         202310
ssl.record.version              202310
ssl.record.length               202310
arp.opcode                      213188
http.response.code              220653
http.content_length             220651
http.response_number            220653
http.request_number             220614
classicstun.type                215134
classicstun.length              215134
udp.srcport                     193105
udp.dstport                     193105
udp.length                      193105
udp.checksum.status             193106
udp.stream                      193106
dns.flags.response              217732
dns.flags.opcode                217732
dns.flags.truncated             217732
dns.flags.recdesired            217732
dns.flags.z                     217732
dns.count.queries               217732
dns.count.answers               217732
dns.count.auth_rr               217732
dns.qry.name.len                217848
dns.count.labels                217848
dns.resp.type                   219165
dns.resp.ttl                    219165
dns.resp.len                    219165
ntp.flags.vn                    219694
ntp.flags.mode                  219694
ntp.stratum                     219694
ntp.ppoll                       219694
ntp.rootdelay                   219694
ntp.rootdispersion              219694
ntp.precision                   219694
bootp.type                      219936
bootp.hw.len                    219936
bootp.hops                      219936
bootp.secs                      219936
bootp.flags.bc                  219937
packet_type                          0
class_device_type                    0
class_is_malicious                   0
class_attack_type                    0
dtype: int64
Removing attributes with more than half NaN and inf values.
Dataframe contains NaN values: True


Column | NaN values (after dropping columns)
packet_id                        0
num                              0
len                              0
caplen                           0
timestamp                        0
frame.time_epoch                 0
frame.time_delta                 0
frame.time_delta_displayed       0
frame.time_relative              0
frame.number                     0
frame.len                        0
frame.cap_len                    0
ip.hdr_len                    7597
ip.dsfield.dscp               7597
ip.len                        7597
ip.flags                      7597
ip.flags.df                   7597
ip.flags.mf                   7597
ip.frag_offset                7597
ip.ttl                        7597
ip.proto                      7597
packet_type                      0
class_device_type                0
class_is_malicious               0
class_attack_type                0
dtype: int64
ip.hdr_len [20. 24. nan]
ip.hdr_len  unique values: 2
ip.dsfield.dscp [ 0.  4. 48. 32.  6. 46.  5. nan]
ip.dsfield.dscp  unique values: 7
ip.len [  84.   52. 1280.   81.   40.   60.   83.   76.  186.   64.   85.   63.
  190. 1500.  109.  182.  557.  139.   68.  396.  459.   93.  117.  237.
  277.  152.  132.   71.  175.   90.   74.   96.  119. 1039. 1119.   48.
  206.  281.  205.  328.  990.  451.  291.  176.  624.  384.  477.  146.
  866. 1213.  197.  969.  238. 1000.   77.  366.   82. 1137.  957. 1015.
  115.   95. 1050.   91. 1056. 1331.  681.  178.   79.  126.  465.  411.
  167.  383.  560.  697.  912. 1006. 1373.  166.  391.  993.   61.  274.
  266.   65.  489.  407.  240.  341. 1098.  522. 1100.  487.  570.  623.
   88.  381.  566. 1002.  278.  882.  248.  829.  336.  309.  256. 1170.
   67.  474.  137.  583. 1265.  158. 1206.  755.  757. 1161.  730.  769.
   66.  441.  995.  979. 1200.  174.  233. 1079.  978.  412.  191.  670.
 1072.  201.  370.  932.  437.  261. 1024. 1183.  417.  138.  371.  914.
 1389. 1142.  660. 1058.  180.  170.  322. 1159.  213. 1359. 1180.  800.
  177.  790. 1244. 1202.  862.  221.  349.  250. 1325.  478.  622.  963.
 1057.  284. 1257.  110. 1274. 1488. 1418. 1130. 1188.  347.  940.  317.
 1090. 1078.  387. 1048.  330. 1071.  394. 1204. 1076. 1458.  303.  778.
  554.  136. 1267.  428. 1260. 1203.  316. 1225.  168.  521.  418. 1254.
  346.  269. 1212. 1272. 1026.  452.  327. 1032.  375.  461.  155.  154.
  426. 1066.  448. 1178.  164.  389.  971.  436.   99.  984.  195. 1152.
  333. 1035. 1172. 1253.  104. 1184. 1014.  440.  173.  235.  785.  230.
  169. 1192.  423.  214.  390. 1199.  179. 1068.  352.  111. 1037.  311.
  967.  142. 1293.  475.  409.  410. 1036.  273.  204.  471.  779.  232.
 1247.  927.  832. 1205.   92.  572. 1016. 1055.  584.  684. 1053.  827.
  297.  460.  604. 1144.  312.  415. 1209.  892.  149. 1197.   56.  917.
 1008.  414. 1104.  395.  492.  974.  435.  434.  506. 1001.  657. 1129.
  188.  285. 1266.  246. 1009. 1135.  649.  118.  994.  702.  105.   32.
  576.  921.  569.  264.  127. 1398.  365.  200. 1415.  473. 1063. 1466.
  107. 1154.  586.  231.   62.   58.  851.  129.  446. 1133. 1313. 1150.
  268.  456.  991.  618. 1167.  162. 1292.  160.  165. 1131. 1042.  620.
  450. 1396.  196.  124.  353.  429. 1027.  709. 1097.  690.  726.  601.
  217.  372.  813.  208. 1256.  603.  868.  194.  302. 1044.  889.  427.
 1099.  671.  514.  567.  885.  211.  637. 1449.  359.  458.  374.  249.
  919.  673. 1483.  741.  798. 1273. 1080.  654. 1324.  192.  161.  582.
 1307. 1252. 1169.  552.  677.  516.  692.  575. 1343. 1114.  745.  815.
  497. 1360. 1116.  236. 1413.   73.  476.  143.  777.  338.  444. 1207.
  340. 1148.  760. 1437.  688.  548.  321. 1366.  157.  125. 1492.  653.
 1470. 1141.  525.  529.  573.   97.  605.  689.  621.  141.  509.  445.
 1217.  209.  589.  307. 1181.  265.  669.  541.  877.  339.  717.  749.
  493.  781. 1229.  733.  685.  925. 1085.  941.  809.  103.  397.  861.
  153.  120.  101.  121.   72.  275.  106.  399.  398.  131.  329.  416.
  400.  113.  293.   44.  189.  144.   41.   69.  210.  377.  258.  242.
  199.   38.   28.   36.   80.   70.   nan 1370.  147.   53.   54.   46.
  128.  150.   49.  263.   51.  100.   47.  215.  130.]
ip.len  unique values: 512
ip.flags [40.  0. 21. 20.  1. nan]
ip.flags  unique values: 5
ip.flags.df ['1' '0' nan]
ip.flags.df  unique values: 2
ip.flags.mf ['0' '1' nan]
ip.flags.mf  unique values: 2
ip.frag_offset [   0. 2416. 2432. 2448. 2464. 2480. 2496. 2512. 2528. 2544. 2560. 2576.
 2592. 2608. 2624. 2640. 2656. 2672. 2688. 2704. 2720. 2736. 2752. 2768.
 2784. 2800. 2816. 2832. 2848. 2864. 2880. 2896.  608.  624.  640.  656.
  672.  688.   16.   32.  704.  720.  736.   48.   64.   80.   96.  112.
  128.  144.  160.  176.  192.  208.  224.  240.  256.  272.  288.  304.
  320.  336.  352.  432.  448.  464.  480.  496.  512.  528.  544.  560.
  576.  592.  752.  768.  784.  800.  816.  832.  848.  864.  880.  896.
  912.  928.  944.  960.  368.  384.  400.  416.  976.  992. 1008. 1024.
 1040. 1056. 1072. 1088. 1104. 1120. 1136. 1152. 1504. 1520. 1536. 1552.
 1568. 1584. 1600. 1616. 1632. 1648. 1664. 1680. 1696. 1712. 1728. 1744.
 1760. 1776. 1792. 1808. 1824. 1840. 1856. 1872. 1888. 1904. 1920. 1936.
 1952. 1968. 1984. 2000. 2016. 2032. 2048. 2064. 2080. 2096. 2112. 2128.
 2144. 1264. 1280. 1296. 1312. 1328. 1344. 1360. 1376. 1392. 1408. 1424.
 1440. 1456. 1472. 1488. 1248. 2944. 2960. 2976. 2992. 3008. 2160. 2176.
 2192. 2208. 2224. 2240. 2256. 2272. 2288. 2304. 2320. 2336. 2352. 2368.
 2384. 2400. 1168. 1184. 1200. 1216. 1232. 2912. 2928. 1480.   nan]
ip.frag_offset  unique values: 190
ip.ttl [ 64.  46. 229.  51.  36. 228. 219.  43.  52.  40. 215. 216.  41. 217.
 255. 225. 220. 128. 226. 212. 223.  28. 230. 238.  33. 221. 211. 207.
 231. 239. 214.  34. 222.   1.  38.   4. 108. 105.  35.  53. 227.  49.
  48.  39.  47. 113. 112.  42.  50.  45.  44. 114. 111.  nan  63.  54.
  37.  57.  59.  56.  55.  58.]
ip.ttl  unique values: 61
ip.proto [ 1.  6. 17.  2. nan]
ip.proto  unique values: 4
<class 'pandas.core.frame.DataFrame'>
RangeIndex: 220785 entries, 0 to 220784
Columns: 25 entries, packet_id to class_attack_type
dtypes: float64(19), object(6)
memory usage: 42.1+ MB
Objects: ['ip.flags.df', 'ip.flags.mf', 'packet_type', 'class_device_type', 'class_is_malicious', 'class_attack_type'] 


Handling categorical attributes (label encoding).
ip.flags.df and ip.flags.mf have been incorrectly read as objects.
Converting them to numeric.
Objects: ['class_device_type', 'class_is_malicious', 'class_attack_type'] 

Dropping class_device_type and class_is_malicious.
These are labels for other scenarios.
Encoding label.
Label types before conversion: ['N/A' 'DoS' 'iot-toolkit' 'MITM' 'Scanning']
Label types after conversion: ['N/A' 'DoS' 'iot-toolkit' 'MITM' 'Scanning']

Splitting dataset (test/train): 0.4

Splitting dataset (validation/train): 0.1
X_train_df shape: (119223, 22)
y_train_df shape: (119223,)
X_val_df shape: (13248, 22)
y_val_df shape: (13248,)
X_test_df shape: (88314, 22)
y_test_df shape: (88314,)

Converting dataframe to numpy array.
X_train shape: (119223, 22)
y_train shape: (119223,)
X_val shape: (13248, 22)
y_val shape: (13248,)
X_test shape: (88314, 22)
y_test shape: (88314,)
Applying normalization (standard).

Handling imbalanced label distribution.
Real: Counter({'N/A': 59695, 'Scanning': 27708, 'DoS': 22216, 'MITM': 4956, 'iot-toolkit': 4648})
Over: Counter({'DoS': 59695, 'Scanning': 59695, 'N/A': 59695, 'MITM': 59695, 'iot-toolkit': 59695})
Under: Counter({'DoS': 4648, 'MITM': 4648, 'N/A': 4648, 'Scanning': 4648, 'iot-toolkit': 4648})
Balanced: Counter({'DoS': 10000, 'MITM': 10000, 'N/A': 10000, 'Scanning': 10000, 'iot-toolkit': 10000})
TRAIN: [     0      1      2 ... 119220 119221 119222] TEST: [119223 119224 119225 ... 132468 132469 132470]
Fitting 1 folds for each of 96 candidates, totalling 96 fits
{'criterion': 'gini', 'max_depth': 10, 'min_samples_split': 2, 'splitter': 'best'}
Confusion matrix:
[[44089     0     0     0     0]
 [    0 16538     0     0     0]
 [    0     0  3410     0     0]
 [    0     0     0  3568     0]
 [    0     0     0     0 20709]]



Accuracy: 1.0
Precision: 1.0
Recall: 1.0
F1: 1.0
Cohen Kappa: 1.0
