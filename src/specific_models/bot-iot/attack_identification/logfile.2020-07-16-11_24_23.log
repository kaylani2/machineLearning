Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_1.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_2.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_3.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_4.csv
<class 'pandas.core.frame.DataFrame'>
Int64Index: 3668522 entries, 1 to 3668522
Data columns (total 45 columns):
stime                               float64
flgs                                object
flgs_number                         int64
proto                               object
proto_number                        int64
saddr                               object
sport                               object
daddr                               object
dport                               object
pkts                                int64
bytes                               int64
state                               object
state_number                        int64
ltime                               float64
seq                                 int64
dur                                 float64
mean                                float64
stddev                              float64
sum                                 float64
min                                 float64
max                                 float64
spkts                               int64
dpkts                               int64
sbytes                              int64
dbytes                              int64
rate                                float64
srate                               float64
drate                               float64
TnBPSrcIP                           int64
TnBPDstIP                           int64
TnP_PSrcIP                          int64
TnP_PDstIP                          int64
TnP_PerProto                        int64
TnP_Per_Dport                       int64
AR_P_Proto_P_SrcIP                  float64
AR_P_Proto_P_DstIP                  float64
N_IN_Conn_P_DstIP                   int64
N_IN_Conn_P_SrcIP                   int64
AR_P_Proto_P_Sport                  float64
AR_P_Proto_P_Dport                  float64
Pkts_P_State_P_Protocol_P_DestIP    int64
Pkts_P_State_P_Protocol_P_SrcIP     int64
attack                              int64
category                            object
subcategory                         object
dtypes: float64(15), int64(21), object(9)
memory usage: 1.3+ GB

Dataframe contains NaN values: False
Number of NaN columns: 0
NaN columns: [] 


Attack types: [1 0]
Attack distribution:
1    3668045
0        477
Name: attack, dtype: int64

Cateogry types: ['DoS' 'DDoS' 'Normal' 'Reconnaissance' 'Theft']
Cateogry distribution:
DDoS              1926624
DoS               1650260
Reconnaissance      91082
Normal                477
Theft                  79
Name: category, dtype: int64

Subcategory types: ['HTTP' 'TCP' 'UDP' 'Normal' 'OS_Fingerprint' 'Service_Scan'
 'Data_Exfiltration' 'Keylogging']
Subcategory distribution:
UDP                  1981230
TCP                  1593180
Service_Scan           73168
OS_Fingerprint         17914
HTTP                    2474
Normal                   477
Keylogging                73
Data_Exfiltration          6
Name: subcategory, dtype: int64

Column | # of different values
stime | 392259
flgs | 9
flgs_number | 9
proto | 5
proto_number | 5
saddr | 21
sport | 65541
daddr | 84
dport | 7698
pkts | 123
bytes | 1633
state | 11
state_number | 11
ltime | 383624
seq | 262212
dur | 612509
mean | 507089
stddev | 421379
sum | 934972
min | 271147
max | 594525
spkts | 91
dpkts | 62
sbytes | 1052
dbytes | 472
rate | 139677
srate | 119709
drate | 20714
TnBPSrcIP | 8639
TnBPDstIP | 7631
TnP_PSrcIP | 1522
TnP_PDstIP | 1587
TnP_PerProto | 1560
TnP_Per_Dport | 1582
AR_P_Proto_P_SrcIP | 46289
AR_P_Proto_P_DstIP | 39186
N_IN_Conn_P_DstIP | 100
N_IN_Conn_P_SrcIP | 100
AR_P_Proto_P_Sport | 136207
AR_P_Proto_P_Dport | 42237
Pkts_P_State_P_Protocol_P_DestIP | 1595
Pkts_P_State_P_Protocol_P_SrcIP | 1526
attack | 2
category | 5
subcategory | 8

Removing attributes that have only one (or zero) sampled value.

Column | # of different values
stime | 392259
flgs | 9
flgs_number | 9
proto | 5
proto_number | 5
saddr | 21
sport | 65541
daddr | 84
dport | 7698
pkts | 123
bytes | 1633
state | 11
state_number | 11
ltime | 383624
seq | 262212
dur | 612509
mean | 507089
stddev | 421379
sum | 934972
min | 271147
max | 594525
spkts | 91
dpkts | 62
sbytes | 1052
dbytes | 472
rate | 139677
srate | 119709
drate | 20714
TnBPSrcIP | 8639
TnBPDstIP | 7631
TnP_PSrcIP | 1522
TnP_PDstIP | 1587
TnP_PerProto | 1560
TnP_Per_Dport | 1582
AR_P_Proto_P_SrcIP | 46289
AR_P_Proto_P_DstIP | 39186
N_IN_Conn_P_DstIP | 100
N_IN_Conn_P_SrcIP | 100
AR_P_Proto_P_Sport | 136207
AR_P_Proto_P_Dport | 42237
Pkts_P_State_P_Protocol_P_DestIP | 1595
Pkts_P_State_P_Protocol_P_SrcIP | 1526
attack | 2
category | 5
subcategory | 8

Removing redundant columns: ['state_number', 'proto_number', 'flgs_number']

Column | NaN values
stime                               0
flgs                                0
proto                               0
saddr                               0
sport                               0
daddr                               0
dport                               0
pkts                                0
bytes                               0
state                               0
ltime                               0
seq                                 0
dur                                 0
mean                                0
stddev                              0
sum                                 0
min                                 0
max                                 0
spkts                               0
dpkts                               0
sbytes                              0
dbytes                              0
rate                                0
srate                               0
drate                               0
TnBPSrcIP                           0
TnBPDstIP                           0
TnP_PSrcIP                          0
TnP_PDstIP                          0
TnP_PerProto                        0
TnP_Per_Dport                       0
AR_P_Proto_P_SrcIP                  0
AR_P_Proto_P_DstIP                  0
N_IN_Conn_P_DstIP                   0
N_IN_Conn_P_SrcIP                   0
AR_P_Proto_P_Sport                  0
AR_P_Proto_P_Dport                  0
Pkts_P_State_P_Protocol_P_DestIP    0
Pkts_P_State_P_Protocol_P_SrcIP     0
attack                              0
category                            0
subcategory                         0
dtype: int64
Removing attributes with more than half NaN values.
Dataframe contains NaN values: False

Column | NaN values (after dropping columns)
stime                               0
flgs                                0
proto                               0
saddr                               0
sport                               0
daddr                               0
dport                               0
pkts                                0
bytes                               0
state                               0
ltime                               0
seq                                 0
dur                                 0
mean                                0
stddev                              0
sum                                 0
min                                 0
max                                 0
spkts                               0
dpkts                               0
sbytes                              0
dbytes                              0
rate                                0
srate                               0
drate                               0
TnBPSrcIP                           0
TnBPDstIP                           0
TnP_PSrcIP                          0
TnP_PDstIP                          0
TnP_PerProto                        0
TnP_Per_Dport                       0
AR_P_Proto_P_SrcIP                  0
AR_P_Proto_P_DstIP                  0
N_IN_Conn_P_DstIP                   0
N_IN_Conn_P_SrcIP                   0
AR_P_Proto_P_Sport                  0
AR_P_Proto_P_Dport                  0
Pkts_P_State_P_Protocol_P_DestIP    0
Pkts_P_State_P_Protocol_P_SrcIP     0
attack                              0
category                            0
subcategory                         0
dtype: int642020-07-16 11:25:13.398132: W tensorflow/stream_executor/platform/default/dso_loader.cc:55] Could not load dynamic library 'libcuda.so.1'; dlerror: libcuda.so.1: cannot open shared object file: No such file or directory
2020-07-16 11:25:13.398262: E tensorflow/stream_executor/cuda/cuda_driver.cc:313] failed call to cuInit: UNKNOWN ERROR (303)
2020-07-16 11:25:13.398308: I tensorflow/stream_executor/cuda/cuda_diagnostics.cc:156] kernel driver does not appear to be running on this host (ponte): /proc/driver/nvidia/version does not exist
2020-07-16 11:25:13.398452: I tensorflow/core/platform/cpu_feature_guard.cc:143] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2020-07-16 11:25:13.402373: I tensorflow/core/platform/profile_utils/cpu_utils.cc:102] CPU Frequency: 3600000000 Hz
2020-07-16 11:25:13.402490: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x5600595d9a40 initialized for platform Host (this does not guarantee that XLA will be used). Devices:
2020-07-16 11:25:13.402530: I tensorflow/compiler/xla/service/service.cc:176]   StreamExecutor device (0): Host, Default Version

stime unique values: 392259
flgs unique values: 9
proto unique values: 9
saddr unique values: 5
sport unique values: 5
daddr unique values: 21
dport unique values: 65541
pkts unique values: 84
bytes unique values: 7698
state unique values: 123
ltime unique values: 1633
seq unique values: 11
dur unique values: 11
mean unique values: 383624
stddev unique values: 262212
sum unique values: 612509
min unique values: 507089
max unique values: 421379
spkts unique values: 934972
dpkts unique values: 271147
sbytes unique values: 594525
dbytes unique values: 91
rate unique values: 62
srate unique values: 1052
drate unique values: 472
TnBPSrcIP unique values: 139677
TnBPDstIP unique values: 119709
TnP_PSrcIP unique values: 20714
TnP_PDstIP unique values: 8639
TnP_PerProto unique values: 7631
TnP_Per_Dport unique values: 1522
AR_P_Proto_P_SrcIP unique values: 1587
AR_P_Proto_P_DstIP unique values: 1560
N_IN_Conn_P_DstIP unique values: 1582
N_IN_Conn_P_SrcIP unique values: 46289
AR_P_Proto_P_Sport unique values: 39186
AR_P_Proto_P_Dport unique values: 100
Pkts_P_State_P_Protocol_P_DestIP unique values: 100
Pkts_P_State_P_Protocol_P_SrcIP unique values: 136207
attack unique values: 42237
category unique values: 1595
subcategory unique values: 1526
<class 'pandas.core.frame.DataFrame'>
Int64Index: 3668522 entries, 1 to 3668522
Columns: 42 entries, stime to subcategory
dtypes: float64(15), int64(18), object(9)
memory usage: 1.2+ GB

Objects: ['flgs', 'proto', 'saddr', 'sport', 'daddr', 'dport', 'state', 'category', 'subcategory'] 


Check for high cardinality.
Column | # of different values | values
flgs | 9 | ['e' 'e s' 'e d' 'e *' 'e g' 'eU' 'e &' 'e   t' 'e  D']
proto | 5 | ['tcp' 'arp' 'udp' 'icmp' 'ipv6-icmp']
saddr | 21 | ['192.168.100.147' '192.168.100.7' '192.168.100.148' '192.168.100.6'
 '192.168.100.149' '192.168.100.150' '192.168.100.5' '192.168.100.3'
 '192.168.100.1' '192.168.100.4' '192.168.100.27'
 'fe80::250:56ff:febe:254' '192.168.100.46' 'fe80::250:56ff:febe:26db'
 'fe80::250:56ff:febe:e9d9' 'fe80::c0c0:aa20:45b9:bdd9'
 'fe80::250:56ff:febe:89ee' 'fe80::2c6a:ff9b:7e14:166a'
 'fe80::250:56ff:febe:bf1a' 'fe80::250:56ff:febe:c038' '192.168.100.55']
sport | 65540 | ['49960' nan '49962' ... '0x0008' '0x000d' '0x0011']
daddr | 84 | ['192.168.100.7' '192.168.100.147' '192.168.100.6' '192.168.100.148'
 '192.168.100.5' '192.168.100.3' '192.168.100.149' '192.168.100.150'
 '192.168.100.4' '27.124.125.250' '192.168.100.1' '192.168.100.27'
 '192.168.217.2' '192.168.100.255' '8.8.8.8' 'ff02::1' '255.255.255.255'
 '13.55.154.73' '192.168.100.55' '184.85.248.65' '205.251.194.167'
 '192.5.5.241' '192.35.51.30' '205.251.195.97' '205.251.196.236'
 '199.7.91.13' '192.12.94.30' '52.35.35.13' '216.239.38.10' '199.7.83.42'
 '192.42.93.30' '172.217.25.170' 'ff02::fb' '224.0.0.251' 'ff02::2'
 '129.250.35.250' '91.189.91.157' '216.239.34.10' '192.52.178.30'
 '224.0.0.252' '96.7.49.66' '205.251.193.2' '192.33.4.12' '192.41.162.30'
 '192.36.148.17' '35.165.2.252' '52.11.124.117' '52.201.147.106'
 '216.239.36.10' '192.112.36.4' '192.31.80.30' '91.189.92.40'
 '128.63.2.53' '202.12.27.33' '192.203.230.10' '192.55.83.30'
 '205.251.198.119' '192.33.14.30' '192.58.128.30' '205.251.196.160'
 '205.251.199.148' '192.54.112.30' '156.154.100.3' '199.19.57.1'
 '205.251.194.86' '205.251.199.194' '205.251.199.61' '205.251.195.185'
 '205.251.194.201' '205.251.198.239' '205.251.193.205' '205.251.196.32'
 '198.41.0.4' '192.48.79.30' '199.19.56.1' '156.154.101.3'
 '205.251.197.206' '205.251.192.170' '205.251.195.59' '205.251.198.91'
 '205.251.194.84' '192.26.92.30' '205.251.194.102' '205.251.194.154']
dport | 7697 | ['80' nan '30551' ... '42052' '2660' '2664']
state | 11 | ['RST' 'CON' 'REQ' 'INT' 'URP' 'FIN' 'ACC' 'NRS' 'ECO' 'TST' 'MAS']
category | 5 | ['DoS' 'DDoS' 'Normal' 'Reconnaissance' 'Theft']
subcategory | 8 | ['HTTP' 'TCP' 'UDP' 'Normal' 'OS_Fingerprint' 'Service_Scan'
 'Data_Exfiltration' 'Keylogging']

Handling categorical attributes (label encoding).
Objects: ['category', 'subcategory']

Dropping category and subcategory.
These are labels for other scenarios.

Splitting dataset (test/train): 0.2

Splitting dataset (validation/train): 0.25
X_train_df shape: (2201112, 37)
y_train_df shape: (2201112,)
X_val_df shape: (733705, 37)
y_val_df shape: (733705,)
X_test_df shape: (733705, 37)
y_test_df shape: (733705,)

Converting dataframe to numpy array.
X_train shape: (2201112, 37)
y_train shape: (2201112,)
X_val shape: (733705, 37)
y_val shape: (733705,)
X_test shape: (733705, 37)
y_test shape: (733705,)

Applying normalization.
1.394124984741211 to normalize data.
7
(2201112, 7, 7, 1)
(733705, 7, 7, 1)
(733705, 7, 7, 1)
Model: "sequential"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d (Conv2D)              (None, 6, 6, 64)          320       
_________________________________________________________________
conv2d_1 (Conv2D)            (None, 5, 5, 64)          16448     
_________________________________________________________________
max_pooling2d (MaxPooling2D) (None, 2, 2, 64)          0         
_________________________________________________________________
flatten (Flatten)            (None, 256)               0         
_________________________________________________________________
dropout (Dropout)            (None, 256)               0         
_________________________________________________________________
dense (Dense)                (None, 64)                16448     
_________________________________________________________________
dense_1 (Dense)              (None, 1)                 65        
=================================================================
Total params: 33,281
Trainable params: 33,281
Non-trainable params: 0
_________________________________________________________________

Fitting the network.
Epoch 1/10
441/441 - 148s - loss: 0.0209 - binary_accuracy: 0.9982 - precision: 0.9999 - val_binary_accuracy: 0.9999 - val_precision: 0.9999 - val_loss: 9.6316e-04
Epoch 2/10
441/441 - 145s - loss: 6.6502e-04 - binary_accuracy: 0.9999 - precision: 0.9999 - val_binary_accuracy: 0.9999 - val_precision: 0.9999 - val_loss: 2.4944e-04
Epoch 3/10
441/441 - 146s - loss: 3.1533e-04 - binary_accuracy: 0.9999 - precision: 0.9999 - val_binary_accuracy: 0.9999 - val_precision: 1.0000 - val_loss: 1.3034e-04
Epoch 4/10
441/441 - 149s - loss: 1.4986e-04 - binary_accuracy: 1.0000 - precision: 1.0000 - val_binary_accuracy: 1.0000 - val_precision: 1.0000 - val_loss: 9.1431e-05
Epoch 5/10
441/441 - 149s - loss: 1.5697e-04 - binary_accuracy: 1.0000 - precision: 1.0000 - val_binary_accuracy: 0.9999 - val_precision: 0.9999 - val_loss: 1.3360e-04
Epoch 6/10
441/441 - 144s - loss: 1.6066e-04 - binary_accuracy: 1.0000 - precision: 1.0000 - val_binary_accuracy: 1.0000 - val_precision: 1.0000 - val_loss: 7.4918e-05
Epoch 7/10
441/441 - 144s - loss: 9.8359e-05 - binary_accuracy: 1.0000 - precision: 1.0000 - val_binary_accuracy: 1.0000 - val_precision: 1.0000 - val_loss: 7.8813e-05
Epoch 8/10
441/441 - 144s - loss: 9.0073e-05 - binary_accuracy: 1.0000 - precision: 1.0000 - val_binary_accuracy: 1.0000 - val_precision: 1.0000 - val_loss: 6.3600e-05
Epoch 9/10
441/441 - 145s - loss: 8.5822e-05 - binary_accuracy: 1.0000 - precision: 1.0000 - val_binary_accuracy: 1.0000 - val_precision: 1.0000 - val_loss: 7.2453e-05
Epoch 10/10
441/441 - 143s - loss: 8.2373e-05 - binary_accuracy: 1.0000 - precision: 1.0000 - val_binary_accuracy: 1.0000 - val_precision: 1.0000 - val_loss: 7.0546e-05
1462.420726299286 s to train model.

Performance on VALIDATION set:
Confusion matrix:
[[733596     14]
 [     3     92]]
Accuracy: 0.9999768299248335
Precision: 0.933960219437142
Recall: 0.9842009844611256
F1: 0.9577056494737332

Performance on TEST set:
Confusion matrix:
[[733597     13]
 [     4     91]]
Accuracy: 0.9999768299248335
Precision: 0.9374972737223641
Recall: 0.9789385081274361
F1: 0.9572806388563646
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_1.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_2.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_3.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_4.csv
<class 'pandas.core.frame.DataFrame'>
Int64Index: 3668522 entries, 1 to 3668522
Data columns (total 45 columns):
stime                               float64
flgs                                object
flgs_number                         int64
proto                               object
proto_number                        int64
saddr                               object
sport                               object
daddr                               object
dport                               object
pkts                                int64
bytes                               int64
state                               object
state_number                        int64
ltime                               float64
seq                                 int64
dur                                 float64
mean                                float64
stddev                              float64
sum                                 float64
min                                 float64
max                                 float64
spkts                               int64
dpkts                               int64
sbytes                              int64
dbytes                              int64
rate                                float64
srate                               float64
drate                               float64
TnBPSrcIP                           int64
TnBPDstIP                           int64
TnP_PSrcIP                          int64
TnP_PDstIP                          int64
TnP_PerProto                        int64
TnP_Per_Dport                       int64
AR_P_Proto_P_SrcIP                  float64
AR_P_Proto_P_DstIP                  float64
N_IN_Conn_P_DstIP                   int64
N_IN_Conn_P_SrcIP                   int64
AR_P_Proto_P_Sport                  float64
AR_P_Proto_P_Dport                  float64
Pkts_P_State_P_Protocol_P_DestIP    int64
Pkts_P_State_P_Protocol_P_SrcIP     int64
attack                              int64
category                            object
subcategory                         object
dtypes: float64(15), int64(21), object(9)
memory usage: 1.3+ GB

Dataframe contains NaN values: False
Number of NaN columns: 0
NaN columns: [] 


Attack types: [1 0]
Attack distribution:
1    3668045
0        477
Name: attack, dtype: int64

Cateogry types: ['DoS' 'DDoS' 'Normal' 'Reconnaissance' 'Theft']
Cateogry distribution:
DDoS              1926624
DoS               1650260
Reconnaissance      91082
Normal                477
Theft                  79
Name: category, dtype: int64

Subcategory types: ['HTTP' 'TCP' 'UDP' 'Normal' 'OS_Fingerprint' 'Service_Scan'
 'Data_Exfiltration' 'Keylogging']
Subcategory distribution:
UDP                  1981230
TCP                  1593180
Service_Scan           73168
OS_Fingerprint         17914
HTTP                    2474
Normal                   477
Keylogging                73
Data_Exfiltration          6
Name: subcategory, dtype: int64

Column | # of different values
stime | 392259
flgs | 9
flgs_number | 9
proto | 5
proto_number | 5
saddr | 21
sport | 65541
daddr | 84
dport | 7698
pkts | 123
bytes | 1633
state | 11
state_number | 11
ltime | 383624
seq | 262212
dur | 612509
mean | 507089
stddev | 421379
sum | 934972
min | 271147
max | 594525
spkts | 91
dpkts | 62
sbytes | 1052
dbytes | 472
rate | 139677
srate | 119709
drate | 20714
TnBPSrcIP | 8639
TnBPDstIP | 7631
TnP_PSrcIP | 1522
TnP_PDstIP | 1587
TnP_PerProto | 1560
TnP_Per_Dport | 1582
AR_P_Proto_P_SrcIP | 46289
AR_P_Proto_P_DstIP | 39186
N_IN_Conn_P_DstIP | 100
N_IN_Conn_P_SrcIP | 100
AR_P_Proto_P_Sport | 136207
AR_P_Proto_P_Dport | 42237
Pkts_P_State_P_Protocol_P_DestIP | 1595
Pkts_P_State_P_Protocol_P_SrcIP | 1526
attack | 2
category | 5
subcategory | 8

Removing attributes that have only one (or zero) sampled value.

Column | # of different values
stime | 392259
flgs | 9
flgs_number | 9
proto | 5
proto_number | 5
saddr | 21
sport | 65541
daddr | 84
dport | 7698
pkts | 123
bytes | 1633
state | 11
state_number | 11
ltime | 383624
seq | 262212
dur | 612509
mean | 507089
stddev | 421379
sum | 934972
min | 271147
max | 594525
spkts | 91
dpkts | 62
sbytes | 1052
dbytes | 472
rate | 139677
srate | 119709
drate | 20714
TnBPSrcIP | 8639
TnBPDstIP | 7631
TnP_PSrcIP | 1522
TnP_PDstIP | 1587
TnP_PerProto | 1560
TnP_Per_Dport | 1582
AR_P_Proto_P_SrcIP | 46289
AR_P_Proto_P_DstIP | 39186
N_IN_Conn_P_DstIP | 100
N_IN_Conn_P_SrcIP | 100
AR_P_Proto_P_Sport | 136207
AR_P_Proto_P_Dport | 42237
Pkts_P_State_P_Protocol_P_DestIP | 1595
Pkts_P_State_P_Protocol_P_SrcIP | 1526
attack | 2
category | 5
subcategory | 8

Removing redundant columns: ['state_number', 'proto_number', 'flgs_number']

Column | NaN values
stime                               0
flgs                                0
proto                               0
saddr                               0
sport                               0
daddr                               0
dport                               0
pkts                                0
bytes                               0
state                               0
ltime                               0
seq                                 0
dur                                 0
mean                                0
stddev                              0
sum                                 0
min                                 0
max                                 0
spkts                               0
dpkts                               0
sbytes                              0
dbytes                              0
rate                                0
srate                               0
drate                               0
TnBPSrcIP                           0
TnBPDstIP                           0
TnP_PSrcIP                          0
TnP_PDstIP                          0
TnP_PerProto                        0
TnP_Per_Dport                       0
AR_P_Proto_P_SrcIP                  0
AR_P_Proto_P_DstIP                  0
N_IN_Conn_P_DstIP                   0
N_IN_Conn_P_SrcIP                   0
AR_P_Proto_P_Sport                  0
AR_P_Proto_P_Dport                  0
Pkts_P_State_P_Protocol_P_DestIP    0
Pkts_P_State_P_Protocol_P_SrcIP     0
attack                              0
category                            0
subcategory                         0
dtype: int64
Removing attributes with more than half NaN values.
Dataframe contains NaN values: False

Column | NaN values (after dropping columns)
stime                               0
flgs                                0
proto                               0
saddr                               0
sport                               0
daddr                               0
dport                               0
pkts                                0
bytes                               0
state                               0
ltime                               0
seq                                 0
dur                                 0
mean                                0
stddev                              0
sum                                 0
min                                 0
max                                 0
spkts                               0
dpkts                               0
sbytes                              0
dbytes                              0
rate                                0
srate                               0
drate                               0
TnBPSrcIP                           0
TnBPDstIP                           0
TnP_PSrcIP                          0
TnP_PDstIP                          0
TnP_PerProto                        0
TnP_Per_Dport                       0
AR_P_Proto_P_SrcIP                  0
AR_P_Proto_P_DstIP                  0
N_IN_Conn_P_DstIP                   0
N_IN_Conn_P_SrcIP                   0
AR_P_Proto_P_Sport                  0
AR_P_Proto_P_Dport                  0
Pkts_P_State_P_Protocol_P_DestIP    0
Pkts_P_State_P_Protocol_P_SrcIP     0
attack                              0
category                            0
subcategory                         0
dtype: int64
stime unique values: 392259
flgs unique values: 9
proto unique values: 9
saddr unique values: 5
sport unique values: 5
daddr unique values: 21
dport unique values: 65541
pkts unique values: 84
bytes unique values: 7698
state unique values: 123
ltime unique values: 1633
seq unique values: 11
dur unique values: 11
mean unique values: 383624
stddev unique values: 262212
sum unique values: 612509
min unique values: 507089
max unique values: 421379
spkts unique values: 934972
dpkts unique values: 271147
sbytes unique values: 594525
dbytes unique values: 91
rate unique values: 62
srate unique values: 1052
drate unique values: 472
TnBPSrcIP unique values: 139677
TnBPDstIP unique values: 119709
TnP_PSrcIP unique values: 20714
TnP_PDstIP unique values: 8639
TnP_PerProto unique values: 7631
TnP_Per_Dport unique values: 1522
AR_P_Proto_P_SrcIP unique values: 1587
AR_P_Proto_P_DstIP unique values: 1560
N_IN_Conn_P_DstIP unique values: 1582
N_IN_Conn_P_SrcIP unique values: 46289
AR_P_Proto_P_Sport unique values: 39186
AR_P_Proto_P_Dport unique values: 100
Pkts_P_State_P_Protocol_P_DestIP unique values: 100
Pkts_P_State_P_Protocol_P_SrcIP unique values: 136207
attack unique values: 42237
category unique values: 1595
subcategory unique values: 1526
<class 'pandas.core.frame.DataFrame'>
Int64Index: 3668522 entries, 1 to 3668522
Columns: 42 entries, stime to subcategory
dtypes: float64(15), int64(18), object(9)
memory usage: 1.2+ GB

Objects: ['flgs', 'proto', 'saddr', 'sport', 'daddr', 'dport', 'state', 'category', 'subcategory'] 


Check for high cardinality.
Column | # of different values | values
flgs | 9 | ['e' 'e s' 'e d' 'e *' 'e g' 'eU' 'e &' 'e   t' 'e  D']
proto | 5 | ['tcp' 'arp' 'udp' 'icmp' 'ipv6-icmp']
saddr | 21 | ['192.168.100.147' '192.168.100.7' '192.168.100.148' '192.168.100.6'
 '192.168.100.149' '192.168.100.150' '192.168.100.5' '192.168.100.3'
 '192.168.100.1' '192.168.100.4' '192.168.100.27'
 'fe80::250:56ff:febe:254' '192.168.100.46' 'fe80::250:56ff:febe:26db'
 'fe80::250:56ff:febe:e9d9' 'fe80::c0c0:aa20:45b9:bdd9'
 'fe80::250:56ff:febe:89ee' 'fe80::2c6a:ff9b:7e14:166a'
 'fe80::250:56ff:febe:bf1a' 'fe80::250:56ff:febe:c038' '192.168.100.55']
sport | 65540 | ['49960' nan '49962' ... '0x0008' '0x000d' '0x0011']
daddr | 84 | ['192.168.100.7' '192.168.100.147' '192.168.100.6' '192.168.100.148'
 '192.168.100.5' '192.168.100.3' '192.168.100.149' '192.168.100.150'
 '192.168.100.4' '27.124.125.250' '192.168.100.1' '192.168.100.27'
 '192.168.217.2' '192.168.100.255' '8.8.8.8' 'ff02::1' '255.255.255.255'
 '13.55.154.73' '192.168.100.55' '184.85.248.65' '205.251.194.167'
 '192.5.5.241' '192.35.51.30' '205.251.195.97' '205.251.196.236'
 '199.7.91.13' '192.12.94.30' '52.35.35.13' '216.239.38.10' '199.7.83.42'
 '192.42.93.30' '172.217.25.170' 'ff02::fb' '224.0.0.251' 'ff02::2'
 '129.250.35.250' '91.189.91.157' '216.239.34.10' '192.52.178.30'
 '224.0.0.252' '96.7.49.66' '205.251.193.2' '192.33.4.12' '192.41.162.30'
 '192.36.148.17' '35.165.2.252' '52.11.124.117' '52.201.147.106'
 '216.239.36.10' '192.112.36.4' '192.31.80.30' '91.189.92.40'
 '128.63.2.53' '202.12.27.33' '192.203.230.10' '192.55.83.30'
 '205.251.198.119' '192.33.14.30' '192.58.128.30' '205.251.196.160'
 '205.251.199.148' '192.54.112.30' '156.154.100.3' '199.19.57.1'
 '205.251.194.86' '205.251.199.194' '205.251.199.61' '205.251.195.185'
 '205.251.194.201' '205.251.198.239' '205.251.193.205' '205.251.196.32'
 '198.41.0.4' '192.48.79.30' '199.19.56.1' '156.154.101.3'
 '205.251.197.206' '205.251.192.170' '205.251.195.59' '205.251.198.91'
 '205.251.194.84' '192.26.92.30' '205.251.194.102' '205.251.194.154']
dport | 7697 | ['80' nan '30551' ... '42052' '2660' '2664']
state | 11 | ['RST' 'CON' 'REQ' 'INT' 'URP' 'FIN' 'ACC' 'NRS' 'ECO' 'TST' 'MAS']
category | 5 | ['DoS' 'DDoS' 'Normal' 'Reconnaissance' 'Theft']
subcategory | 8 | ['HTTP' 'TCP' 'UDP' 'Normal' 'OS_Fingerprint' 'Service_Scan'
 'Data_Exfiltration' 'Keylogging']

Handling categorical attributes (label encoding).
Objects: ['category', 'subcategory']

Dropping category and subcategory.
These are labels for other scenarios.

Splitting dataset (test/train): 0.2

Splitting dataset (validation/train): 0.25
X_train_df shape: (2201112, 37)
y_train_df shape: (2201112,)
X_val_df shape: (733705, 37)
y_val_df shape: (733705,)
X_test_df shape: (733705, 37)
y_test_df shape: (733705,)

Converting dataframe to numpy array.
X_train shape: (2201112, 37)
y_train shape: (2201112,)
X_val shape: (733705, 37)
y_val shape: (733705,)
X_test shape: (733705, 37)
y_test shape: (733705,)

Applying normalization.
1.4912185668945312 to normalize data.
7
(2201112, 7, 7, 1)
(733705, 7, 7, 1)
(733705, 7, 7, 1)
Model: "sequential_1"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_2 (Conv2D)            (None, 6, 6, 64)          320       
_________________________________________________________________
conv2d_3 (Conv2D)            (None, 5, 5, 64)          16448     
_________________________________________________________________
max_pooling2d_1 (MaxPooling2 (None, 2, 2, 64)          0         
_________________________________________________________________
flatten_1 (Flatten)          (None, 256)               0         
_________________________________________________________________
dropout_1 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_2 (Dense)              (None, 64)                16448     
_________________________________________________________________
dense_3 (Dense)              (None, 1)                 65        
=================================================================
Total params: 33,281
Trainable params: 33,281
Non-trainable params: 0
_________________________________________________________________

Fitting the network.
Epoch 1/10
441/441 - 145s - precision_1: 0.9999 - loss: 0.0228 - binary_accuracy: 0.9982 - val_binary_accuracy: 0.9999 - val_loss: 9.5036e-04 - val_precision_1: 0.9999
Epoch 2/10
441/441 - 145s - precision_1: 0.9999 - loss: 4.9614e-04 - binary_accuracy: 0.9999 - val_binary_accuracy: 0.9999 - val_loss: 1.6756e-04 - val_precision_1: 1.0000
Epoch 3/10
441/441 - 145s - precision_1: 1.0000 - loss: 2.1627e-04 - binary_accuracy: 0.9999 - val_binary_accuracy: 1.0000 - val_loss: 1.1254e-04 - val_precision_1: 1.0000
Epoch 4/10
441/441 - 144s - precision_1: 1.0000 - loss: 2.0645e-04 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 1.3537e-04 - val_precision_1: 1.0000
Epoch 5/10
441/441 - 145s - precision_1: 1.0000 - loss: 1.4839e-04 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 6.6775e-05 - val_precision_1: 1.0000
Epoch 6/10
441/441 - 144s - precision_1: 1.0000 - loss: 1.3178e-04 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 1.0122e-04 - val_precision_1: 1.0000
Epoch 7/10
441/441 - 144s - precision_1: 1.0000 - loss: 1.2579e-04 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 9.0136e-05 - val_precision_1: 1.0000
Epoch 8/10
441/441 - 144s - precision_1: 1.0000 - loss: 9.5061e-05 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 1.3852e-04 - val_precision_1: 1.0000
Epoch 9/10
441/441 - 143s - precision_1: 1.0000 - loss: 1.1230e-04 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 1.2806e-04 - val_precision_1: 1.0000
Epoch 10/10
441/441 - 141s - precision_1: 1.0000 - loss: 1.0925e-04 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 7.9923e-05 - val_precision_1: 1.0000
1444.3604028224945 s to train model.

Performance on VALIDATION set:
Confusion matrix:
[[733588     17]
 [     5     95]]
Accuracy: 0.9999700151968434
Precision: 0.9241037349729346
Recall: 0.9749884133832238
F1: 0.9481057102632313

Performance on TEST set:
Confusion matrix:
[[733595     14]
 [     5     91]]
Accuracy: 0.9999741040336375
Precision: 0.9333299254816431
Recall: 0.9739487914656626
F1: 0.9527298435294664
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_1.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_2.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_3.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_4.csv
<class 'pandas.core.frame.DataFrame'>
Int64Index: 3668522 entries, 1 to 3668522
Data columns (total 45 columns):
stime                               float64
flgs                                object
flgs_number                         int64
proto                               object
proto_number                        int64
saddr                               object
sport                               object
daddr                               object
dport                               object
pkts                                int64
bytes                               int64
state                               object
state_number                        int64
ltime                               float64
seq                                 int64
dur                                 float64
mean                                float64
stddev                              float64
sum                                 float64
min                                 float64
max                                 float64
spkts                               int64
dpkts                               int64
sbytes                              int64
dbytes                              int64
rate                                float64
srate                               float64
drate                               float64
TnBPSrcIP                           int64
TnBPDstIP                           int64
TnP_PSrcIP                          int64
TnP_PDstIP                          int64
TnP_PerProto                        int64
TnP_Per_Dport                       int64
AR_P_Proto_P_SrcIP                  float64
AR_P_Proto_P_DstIP                  float64
N_IN_Conn_P_DstIP                   int64
N_IN_Conn_P_SrcIP                   int64
AR_P_Proto_P_Sport                  float64
AR_P_Proto_P_Dport                  float64
Pkts_P_State_P_Protocol_P_DestIP    int64
Pkts_P_State_P_Protocol_P_SrcIP     int64
attack                              int64
category                            object
subcategory                         object
dtypes: float64(15), int64(21), object(9)
memory usage: 1.3+ GB

Dataframe contains NaN values: False
Number of NaN columns: 0
NaN columns: [] 


Attack types: [1 0]
Attack distribution:
1    3668045
0        477
Name: attack, dtype: int64

Cateogry types: ['DoS' 'DDoS' 'Normal' 'Reconnaissance' 'Theft']
Cateogry distribution:
DDoS              1926624
DoS               1650260
Reconnaissance      91082
Normal                477
Theft                  79
Name: category, dtype: int64

Subcategory types: ['HTTP' 'TCP' 'UDP' 'Normal' 'OS_Fingerprint' 'Service_Scan'
 'Data_Exfiltration' 'Keylogging']
Subcategory distribution:
UDP                  1981230
TCP                  1593180
Service_Scan           73168
OS_Fingerprint         17914
HTTP                    2474
Normal                   477
Keylogging                73
Data_Exfiltration          6
Name: subcategory, dtype: int64

Column | # of different values
stime | 392259
flgs | 9
flgs_number | 9
proto | 5
proto_number | 5
saddr | 21
sport | 65541
daddr | 84
dport | 7698
pkts | 123
bytes | 1633
state | 11
state_number | 11
ltime | 383624
seq | 262212
dur | 612509
mean | 507089
stddev | 421379
sum | 934972
min | 271147
max | 594525
spkts | 91
dpkts | 62
sbytes | 1052
dbytes | 472
rate | 139677
srate | 119709
drate | 20714
TnBPSrcIP | 8639
TnBPDstIP | 7631
TnP_PSrcIP | 1522
TnP_PDstIP | 1587
TnP_PerProto | 1560
TnP_Per_Dport | 1582
AR_P_Proto_P_SrcIP | 46289
AR_P_Proto_P_DstIP | 39186
N_IN_Conn_P_DstIP | 100
N_IN_Conn_P_SrcIP | 100
AR_P_Proto_P_Sport | 136207
AR_P_Proto_P_Dport | 42237
Pkts_P_State_P_Protocol_P_DestIP | 1595
Pkts_P_State_P_Protocol_P_SrcIP | 1526
attack | 2
category | 5
subcategory | 8

Removing attributes that have only one (or zero) sampled value.

Column | # of different values
stime | 392259
flgs | 9
flgs_number | 9
proto | 5
proto_number | 5
saddr | 21
sport | 65541
daddr | 84
dport | 7698
pkts | 123
bytes | 1633
state | 11
state_number | 11
ltime | 383624
seq | 262212
dur | 612509
mean | 507089
stddev | 421379
sum | 934972
min | 271147
max | 594525
spkts | 91
dpkts | 62
sbytes | 1052
dbytes | 472
rate | 139677
srate | 119709
drate | 20714
TnBPSrcIP | 8639
TnBPDstIP | 7631
TnP_PSrcIP | 1522
TnP_PDstIP | 1587
TnP_PerProto | 1560
TnP_Per_Dport | 1582
AR_P_Proto_P_SrcIP | 46289
AR_P_Proto_P_DstIP | 39186
N_IN_Conn_P_DstIP | 100
N_IN_Conn_P_SrcIP | 100
AR_P_Proto_P_Sport | 136207
AR_P_Proto_P_Dport | 42237
Pkts_P_State_P_Protocol_P_DestIP | 1595
Pkts_P_State_P_Protocol_P_SrcIP | 1526
attack | 2
category | 5
subcategory | 8

Removing redundant columns: ['state_number', 'proto_number', 'flgs_number']

Column | NaN values
stime                               0
flgs                                0
proto                               0
saddr                               0
sport                               0
daddr                               0
dport                               0
pkts                                0
bytes                               0
state                               0
ltime                               0
seq                                 0
dur                                 0
mean                                0
stddev                              0
sum                                 0
min                                 0
max                                 0
spkts                               0
dpkts                               0
sbytes                              0
dbytes                              0
rate                                0
srate                               0
drate                               0
TnBPSrcIP                           0
TnBPDstIP                           0
TnP_PSrcIP                          0
TnP_PDstIP                          0
TnP_PerProto                        0
TnP_Per_Dport                       0
AR_P_Proto_P_SrcIP                  0
AR_P_Proto_P_DstIP                  0
N_IN_Conn_P_DstIP                   0
N_IN_Conn_P_SrcIP                   0
AR_P_Proto_P_Sport                  0
AR_P_Proto_P_Dport                  0
Pkts_P_State_P_Protocol_P_DestIP    0
Pkts_P_State_P_Protocol_P_SrcIP     0
attack                              0
category                            0
subcategory                         0
dtype: int64
Removing attributes with more than half NaN values.
Dataframe contains NaN values: False

Column | NaN values (after dropping columns)
stime                               0
flgs                                0
proto                               0
saddr                               0
sport                               0
daddr                               0
dport                               0
pkts                                0
bytes                               0
state                               0
ltime                               0
seq                                 0
dur                                 0
mean                                0
stddev                              0
sum                                 0
min                                 0
max                                 0
spkts                               0
dpkts                               0
sbytes                              0
dbytes                              0
rate                                0
srate                               0
drate                               0
TnBPSrcIP                           0
TnBPDstIP                           0
TnP_PSrcIP                          0
TnP_PDstIP                          0
TnP_PerProto                        0
TnP_Per_Dport                       0
AR_P_Proto_P_SrcIP                  0
AR_P_Proto_P_DstIP                  0
N_IN_Conn_P_DstIP                   0
N_IN_Conn_P_SrcIP                   0
AR_P_Proto_P_Sport                  0
AR_P_Proto_P_Dport                  0
Pkts_P_State_P_Protocol_P_DestIP    0
Pkts_P_State_P_Protocol_P_SrcIP     0
attack                              0
category                            0
subcategory                         0
dtype: int64
stime unique values: 392259
flgs unique values: 9
proto unique values: 9
saddr unique values: 5
sport unique values: 5
daddr unique values: 21
dport unique values: 65541
pkts unique values: 84
bytes unique values: 7698
state unique values: 123
ltime unique values: 1633
seq unique values: 11
dur unique values: 11
mean unique values: 383624
stddev unique values: 262212
sum unique values: 612509
min unique values: 507089
max unique values: 421379
spkts unique values: 934972
dpkts unique values: 271147
sbytes unique values: 594525
dbytes unique values: 91
rate unique values: 62
srate unique values: 1052
drate unique values: 472
TnBPSrcIP unique values: 139677
TnBPDstIP unique values: 119709
TnP_PSrcIP unique values: 20714
TnP_PDstIP unique values: 8639
TnP_PerProto unique values: 7631
TnP_Per_Dport unique values: 1522
AR_P_Proto_P_SrcIP unique values: 1587
AR_P_Proto_P_DstIP unique values: 1560
N_IN_Conn_P_DstIP unique values: 1582
N_IN_Conn_P_SrcIP unique values: 46289
AR_P_Proto_P_Sport unique values: 39186
AR_P_Proto_P_Dport unique values: 100
Pkts_P_State_P_Protocol_P_DestIP unique values: 100
Pkts_P_State_P_Protocol_P_SrcIP unique values: 136207
attack unique values: 42237
category unique values: 1595
subcategory unique values: 1526
<class 'pandas.core.frame.DataFrame'>
Int64Index: 3668522 entries, 1 to 3668522
Columns: 42 entries, stime to subcategory
dtypes: float64(15), int64(18), object(9)
memory usage: 1.2+ GB

Objects: ['flgs', 'proto', 'saddr', 'sport', 'daddr', 'dport', 'state', 'category', 'subcategory'] 


Check for high cardinality.
Column | # of different values | values
flgs | 9 | ['e' 'e s' 'e d' 'e *' 'e g' 'eU' 'e &' 'e   t' 'e  D']
proto | 5 | ['tcp' 'arp' 'udp' 'icmp' 'ipv6-icmp']
saddr | 21 | ['192.168.100.147' '192.168.100.7' '192.168.100.148' '192.168.100.6'
 '192.168.100.149' '192.168.100.150' '192.168.100.5' '192.168.100.3'
 '192.168.100.1' '192.168.100.4' '192.168.100.27'
 'fe80::250:56ff:febe:254' '192.168.100.46' 'fe80::250:56ff:febe:26db'
 'fe80::250:56ff:febe:e9d9' 'fe80::c0c0:aa20:45b9:bdd9'
 'fe80::250:56ff:febe:89ee' 'fe80::2c6a:ff9b:7e14:166a'
 'fe80::250:56ff:febe:bf1a' 'fe80::250:56ff:febe:c038' '192.168.100.55']
sport | 65540 | ['49960' nan '49962' ... '0x0008' '0x000d' '0x0011']
daddr | 84 | ['192.168.100.7' '192.168.100.147' '192.168.100.6' '192.168.100.148'
 '192.168.100.5' '192.168.100.3' '192.168.100.149' '192.168.100.150'
 '192.168.100.4' '27.124.125.250' '192.168.100.1' '192.168.100.27'
 '192.168.217.2' '192.168.100.255' '8.8.8.8' 'ff02::1' '255.255.255.255'
 '13.55.154.73' '192.168.100.55' '184.85.248.65' '205.251.194.167'
 '192.5.5.241' '192.35.51.30' '205.251.195.97' '205.251.196.236'
 '199.7.91.13' '192.12.94.30' '52.35.35.13' '216.239.38.10' '199.7.83.42'
 '192.42.93.30' '172.217.25.170' 'ff02::fb' '224.0.0.251' 'ff02::2'
 '129.250.35.250' '91.189.91.157' '216.239.34.10' '192.52.178.30'
 '224.0.0.252' '96.7.49.66' '205.251.193.2' '192.33.4.12' '192.41.162.30'
 '192.36.148.17' '35.165.2.252' '52.11.124.117' '52.201.147.106'
 '216.239.36.10' '192.112.36.4' '192.31.80.30' '91.189.92.40'
 '128.63.2.53' '202.12.27.33' '192.203.230.10' '192.55.83.30'
 '205.251.198.119' '192.33.14.30' '192.58.128.30' '205.251.196.160'
 '205.251.199.148' '192.54.112.30' '156.154.100.3' '199.19.57.1'
 '205.251.194.86' '205.251.199.194' '205.251.199.61' '205.251.195.185'
 '205.251.194.201' '205.251.198.239' '205.251.193.205' '205.251.196.32'
 '198.41.0.4' '192.48.79.30' '199.19.56.1' '156.154.101.3'
 '205.251.197.206' '205.251.192.170' '205.251.195.59' '205.251.198.91'
 '205.251.194.84' '192.26.92.30' '205.251.194.102' '205.251.194.154']
dport | 7697 | ['80' nan '30551' ... '42052' '2660' '2664']
state | 11 | ['RST' 'CON' 'REQ' 'INT' 'URP' 'FIN' 'ACC' 'NRS' 'ECO' 'TST' 'MAS']
category | 5 | ['DoS' 'DDoS' 'Normal' 'Reconnaissance' 'Theft']
subcategory | 8 | ['HTTP' 'TCP' 'UDP' 'Normal' 'OS_Fingerprint' 'Service_Scan'
 'Data_Exfiltration' 'Keylogging']

Handling categorical attributes (label encoding).
Objects: ['category', 'subcategory']

Dropping category and subcategory.
These are labels for other scenarios.

Splitting dataset (test/train): 0.2

Splitting dataset (validation/train): 0.25
X_train_df shape: (2201112, 37)
y_train_df shape: (2201112,)
X_val_df shape: (733705, 37)
y_val_df shape: (733705,)
X_test_df shape: (733705, 37)
y_test_df shape: (733705,)

Converting dataframe to numpy array.
X_train shape: (2201112, 37)
y_train shape: (2201112,)
X_val shape: (733705, 37)
y_val shape: (733705,)
X_test shape: (733705, 37)
y_test shape: (733705,)

Applying normalization.
1.444995641708374 to normalize data.
7
(2201112, 7, 7, 1)
(733705, 7, 7, 1)
(733705, 7, 7, 1)
Model: "sequential_2"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_4 (Conv2D)            (None, 6, 6, 64)          320       
_________________________________________________________________
conv2d_5 (Conv2D)            (None, 5, 5, 64)          16448     
_________________________________________________________________
max_pooling2d_2 (MaxPooling2 (None, 2, 2, 64)          0         
_________________________________________________________________
flatten_2 (Flatten)          (None, 256)               0         
_________________________________________________________________
dropout_2 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_4 (Dense)              (None, 64)                16448     
_________________________________________________________________
dense_5 (Dense)              (None, 1)                 65        
=================================================================
Total params: 33,281
Trainable params: 33,281
Non-trainable params: 0
_________________________________________________________________

Fitting the network.
Epoch 1/10
441/441 - 145s - loss: 0.0218 - binary_accuracy: 0.9982 - precision_2: 0.9999 - val_binary_accuracy: 0.9999 - val_precision_2: 0.9999 - val_loss: 0.0015
Epoch 2/10
441/441 - 145s - loss: 6.9704e-04 - binary_accuracy: 0.9999 - precision_2: 0.9999 - val_binary_accuracy: 0.9999 - val_precision_2: 0.9999 - val_loss: 2.7221e-04
Epoch 3/10
441/441 - 145s - loss: 4.0110e-04 - binary_accuracy: 0.9999 - precision_2: 0.9999 - val_binary_accuracy: 1.0000 - val_precision_2: 1.0000 - val_loss: 1.1427e-04
Epoch 4/10
441/441 - 145s - loss: 1.9064e-04 - binary_accuracy: 0.9999 - precision_2: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_2: 1.0000 - val_loss: 1.2748e-04
Epoch 5/10
441/441 - 145s - loss: 1.6850e-04 - binary_accuracy: 1.0000 - precision_2: 1.0000 - val_binary_accuracy: 0.9999 - val_precision_2: 0.9999 - val_loss: 2.7038e-04
Epoch 6/10
441/441 - 145s - loss: 1.6922e-04 - binary_accuracy: 1.0000 - precision_2: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_2: 1.0000 - val_loss: 9.6809e-05
Epoch 7/10
441/441 - 145s - loss: 1.2002e-04 - binary_accuracy: 1.0000 - precision_2: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_2: 1.0000 - val_loss: 5.2670e-05
Epoch 8/10
441/441 - 145s - loss: 9.0541e-05 - binary_accuracy: 1.0000 - precision_2: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_2: 1.0000 - val_loss: 1.0057e-04
Epoch 9/10
441/441 - 144s - loss: 1.0463e-04 - binary_accuracy: 1.0000 - precision_2: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_2: 1.0000 - val_loss: 7.5376e-05
Epoch 10/10
441/441 - 142s - loss: 1.3430e-04 - binary_accuracy: 1.0000 - precision_2: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_2: 1.0000 - val_loss: 5.1374e-05
1447.6466431617737 s to train model.

Performance on VALIDATION set:
Confusion matrix:
[[733606      8]
 [     7     84]]
Accuracy: 0.9999795558160296
Precision: 0.9565169682226128
Recall: 0.9615330090798117
F1: 0.9590112817591547

Performance on TEST set:
Confusion matrix:
[[733595     18]
 [     9     83]]
Accuracy: 0.9999632004688532
Precision: 0.9108849550093149
Recall: 0.9510746884730541
F1: 0.930042612378549
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_1.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_2.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_3.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_4.csv
<class 'pandas.core.frame.DataFrame'>
Int64Index: 3668522 entries, 1 to 3668522
Data columns (total 45 columns):
stime                               float64
flgs                                object
flgs_number                         int64
proto                               object
proto_number                        int64
saddr                               object
sport                               object
daddr                               object
dport                               object
pkts                                int64
bytes                               int64
state                               object
state_number                        int64
ltime                               float64
seq                                 int64
dur                                 float64
mean                                float64
stddev                              float64
sum                                 float64
min                                 float64
max                                 float64
spkts                               int64
dpkts                               int64
sbytes                              int64
dbytes                              int64
rate                                float64
srate                               float64
drate                               float64
TnBPSrcIP                           int64
TnBPDstIP                           int64
TnP_PSrcIP                          int64
TnP_PDstIP                          int64
TnP_PerProto                        int64
TnP_Per_Dport                       int64
AR_P_Proto_P_SrcIP                  float64
AR_P_Proto_P_DstIP                  float64
N_IN_Conn_P_DstIP                   int64
N_IN_Conn_P_SrcIP                   int64
AR_P_Proto_P_Sport                  float64
AR_P_Proto_P_Dport                  float64
Pkts_P_State_P_Protocol_P_DestIP    int64
Pkts_P_State_P_Protocol_P_SrcIP     int64
attack                              int64
category                            object
subcategory                         object
dtypes: float64(15), int64(21), object(9)
memory usage: 1.3+ GB

Dataframe contains NaN values: False
Number of NaN columns: 0
NaN columns: [] 


Attack types: [1 0]
Attack distribution:
1    3668045
0        477
Name: attack, dtype: int64

Cateogry types: ['DoS' 'DDoS' 'Normal' 'Reconnaissance' 'Theft']
Cateogry distribution:
DDoS              1926624
DoS               1650260
Reconnaissance      91082
Normal                477
Theft                  79
Name: category, dtype: int64

Subcategory types: ['HTTP' 'TCP' 'UDP' 'Normal' 'OS_Fingerprint' 'Service_Scan'
 'Data_Exfiltration' 'Keylogging']
Subcategory distribution:
UDP                  1981230
TCP                  1593180
Service_Scan           73168
OS_Fingerprint         17914
HTTP                    2474
Normal                   477
Keylogging                73
Data_Exfiltration          6
Name: subcategory, dtype: int64

Column | # of different values
stime | 392259
flgs | 9
flgs_number | 9
proto | 5
proto_number | 5
saddr | 21
sport | 65541
daddr | 84
dport | 7698
pkts | 123
bytes | 1633
state | 11
state_number | 11
ltime | 383624
seq | 262212
dur | 612509
mean | 507089
stddev | 421379
sum | 934972
min | 271147
max | 594525
spkts | 91
dpkts | 62
sbytes | 1052
dbytes | 472
rate | 139677
srate | 119709
drate | 20714
TnBPSrcIP | 8639
TnBPDstIP | 7631
TnP_PSrcIP | 1522
TnP_PDstIP | 1587
TnP_PerProto | 1560
TnP_Per_Dport | 1582
AR_P_Proto_P_SrcIP | 46289
AR_P_Proto_P_DstIP | 39186
N_IN_Conn_P_DstIP | 100
N_IN_Conn_P_SrcIP | 100
AR_P_Proto_P_Sport | 136207
AR_P_Proto_P_Dport | 42237
Pkts_P_State_P_Protocol_P_DestIP | 1595
Pkts_P_State_P_Protocol_P_SrcIP | 1526
attack | 2
category | 5
subcategory | 8

Removing attributes that have only one (or zero) sampled value.

Column | # of different values
stime | 392259
flgs | 9
flgs_number | 9
proto | 5
proto_number | 5
saddr | 21
sport | 65541
daddr | 84
dport | 7698
pkts | 123
bytes | 1633
state | 11
state_number | 11
ltime | 383624
seq | 262212
dur | 612509
mean | 507089
stddev | 421379
sum | 934972
min | 271147
max | 594525
spkts | 91
dpkts | 62
sbytes | 1052
dbytes | 472
rate | 139677
srate | 119709
drate | 20714
TnBPSrcIP | 8639
TnBPDstIP | 7631
TnP_PSrcIP | 1522
TnP_PDstIP | 1587
TnP_PerProto | 1560
TnP_Per_Dport | 1582
AR_P_Proto_P_SrcIP | 46289
AR_P_Proto_P_DstIP | 39186
N_IN_Conn_P_DstIP | 100
N_IN_Conn_P_SrcIP | 100
AR_P_Proto_P_Sport | 136207
AR_P_Proto_P_Dport | 42237
Pkts_P_State_P_Protocol_P_DestIP | 1595
Pkts_P_State_P_Protocol_P_SrcIP | 1526
attack | 2
category | 5
subcategory | 8

Removing redundant columns: ['state_number', 'proto_number', 'flgs_number']

Column | NaN values
stime                               0
flgs                                0
proto                               0
saddr                               0
sport                               0
daddr                               0
dport                               0
pkts                                0
bytes                               0
state                               0
ltime                               0
seq                                 0
dur                                 0
mean                                0
stddev                              0
sum                                 0
min                                 0
max                                 0
spkts                               0
dpkts                               0
sbytes                              0
dbytes                              0
rate                                0
srate                               0
drate                               0
TnBPSrcIP                           0
TnBPDstIP                           0
TnP_PSrcIP                          0
TnP_PDstIP                          0
TnP_PerProto                        0
TnP_Per_Dport                       0
AR_P_Proto_P_SrcIP                  0
AR_P_Proto_P_DstIP                  0
N_IN_Conn_P_DstIP                   0
N_IN_Conn_P_SrcIP                   0
AR_P_Proto_P_Sport                  0
AR_P_Proto_P_Dport                  0
Pkts_P_State_P_Protocol_P_DestIP    0
Pkts_P_State_P_Protocol_P_SrcIP     0
attack                              0
category                            0
subcategory                         0
dtype: int64
Removing attributes with more than half NaN values.
Dataframe contains NaN values: False

Column | NaN values (after dropping columns)
stime                               0
flgs                                0
proto                               0
saddr                               0
sport                               0
daddr                               0
dport                               0
pkts                                0
bytes                               0
state                               0
ltime                               0
seq                                 0
dur                                 0
mean                                0
stddev                              0
sum                                 0
min                                 0
max                                 0
spkts                               0
dpkts                               0
sbytes                              0
dbytes                              0
rate                                0
srate                               0
drate                               0
TnBPSrcIP                           0
TnBPDstIP                           0
TnP_PSrcIP                          0
TnP_PDstIP                          0
TnP_PerProto                        0
TnP_Per_Dport                       0
AR_P_Proto_P_SrcIP                  0
AR_P_Proto_P_DstIP                  0
N_IN_Conn_P_DstIP                   0
N_IN_Conn_P_SrcIP                   0
AR_P_Proto_P_Sport                  0
AR_P_Proto_P_Dport                  0
Pkts_P_State_P_Protocol_P_DestIP    0
Pkts_P_State_P_Protocol_P_SrcIP     0
attack                              0
category                            0
subcategory                         0
dtype: int64
stime unique values: 392259
flgs unique values: 9
proto unique values: 9
saddr unique values: 5
sport unique values: 5
daddr unique values: 21
dport unique values: 65541
pkts unique values: 84
bytes unique values: 7698
state unique values: 123
ltime unique values: 1633
seq unique values: 11
dur unique values: 11
mean unique values: 383624
stddev unique values: 262212
sum unique values: 612509
min unique values: 507089
max unique values: 421379
spkts unique values: 934972
dpkts unique values: 271147
sbytes unique values: 594525
dbytes unique values: 91
rate unique values: 62
srate unique values: 1052
drate unique values: 472
TnBPSrcIP unique values: 139677
TnBPDstIP unique values: 119709
TnP_PSrcIP unique values: 20714
TnP_PDstIP unique values: 8639
TnP_PerProto unique values: 7631
TnP_Per_Dport unique values: 1522
AR_P_Proto_P_SrcIP unique values: 1587
AR_P_Proto_P_DstIP unique values: 1560
N_IN_Conn_P_DstIP unique values: 1582
N_IN_Conn_P_SrcIP unique values: 46289
AR_P_Proto_P_Sport unique values: 39186
AR_P_Proto_P_Dport unique values: 100
Pkts_P_State_P_Protocol_P_DestIP unique values: 100
Pkts_P_State_P_Protocol_P_SrcIP unique values: 136207
attack unique values: 42237
category unique values: 1595
subcategory unique values: 1526
<class 'pandas.core.frame.DataFrame'>
Int64Index: 3668522 entries, 1 to 3668522
Columns: 42 entries, stime to subcategory
dtypes: float64(15), int64(18), object(9)
memory usage: 1.2+ GB

Objects: ['flgs', 'proto', 'saddr', 'sport', 'daddr', 'dport', 'state', 'category', 'subcategory'] 


Check for high cardinality.
Column | # of different values | values
flgs | 9 | ['e' 'e s' 'e d' 'e *' 'e g' 'eU' 'e &' 'e   t' 'e  D']
proto | 5 | ['tcp' 'arp' 'udp' 'icmp' 'ipv6-icmp']
saddr | 21 | ['192.168.100.147' '192.168.100.7' '192.168.100.148' '192.168.100.6'
 '192.168.100.149' '192.168.100.150' '192.168.100.5' '192.168.100.3'
 '192.168.100.1' '192.168.100.4' '192.168.100.27'
 'fe80::250:56ff:febe:254' '192.168.100.46' 'fe80::250:56ff:febe:26db'
 'fe80::250:56ff:febe:e9d9' 'fe80::c0c0:aa20:45b9:bdd9'
 'fe80::250:56ff:febe:89ee' 'fe80::2c6a:ff9b:7e14:166a'
 'fe80::250:56ff:febe:bf1a' 'fe80::250:56ff:febe:c038' '192.168.100.55']
sport | 65540 | ['49960' nan '49962' ... '0x0008' '0x000d' '0x0011']
daddr | 84 | ['192.168.100.7' '192.168.100.147' '192.168.100.6' '192.168.100.148'
 '192.168.100.5' '192.168.100.3' '192.168.100.149' '192.168.100.150'
 '192.168.100.4' '27.124.125.250' '192.168.100.1' '192.168.100.27'
 '192.168.217.2' '192.168.100.255' '8.8.8.8' 'ff02::1' '255.255.255.255'
 '13.55.154.73' '192.168.100.55' '184.85.248.65' '205.251.194.167'
 '192.5.5.241' '192.35.51.30' '205.251.195.97' '205.251.196.236'
 '199.7.91.13' '192.12.94.30' '52.35.35.13' '216.239.38.10' '199.7.83.42'
 '192.42.93.30' '172.217.25.170' 'ff02::fb' '224.0.0.251' 'ff02::2'
 '129.250.35.250' '91.189.91.157' '216.239.34.10' '192.52.178.30'
 '224.0.0.252' '96.7.49.66' '205.251.193.2' '192.33.4.12' '192.41.162.30'
 '192.36.148.17' '35.165.2.252' '52.11.124.117' '52.201.147.106'
 '216.239.36.10' '192.112.36.4' '192.31.80.30' '91.189.92.40'
 '128.63.2.53' '202.12.27.33' '192.203.230.10' '192.55.83.30'
 '205.251.198.119' '192.33.14.30' '192.58.128.30' '205.251.196.160'
 '205.251.199.148' '192.54.112.30' '156.154.100.3' '199.19.57.1'
 '205.251.194.86' '205.251.199.194' '205.251.199.61' '205.251.195.185'
 '205.251.194.201' '205.251.198.239' '205.251.193.205' '205.251.196.32'
 '198.41.0.4' '192.48.79.30' '199.19.56.1' '156.154.101.3'
 '205.251.197.206' '205.251.192.170' '205.251.195.59' '205.251.198.91'
 '205.251.194.84' '192.26.92.30' '205.251.194.102' '205.251.194.154']
dport | 7697 | ['80' nan '30551' ... '42052' '2660' '2664']
state | 11 | ['RST' 'CON' 'REQ' 'INT' 'URP' 'FIN' 'ACC' 'NRS' 'ECO' 'TST' 'MAS']
category | 5 | ['DoS' 'DDoS' 'Normal' 'Reconnaissance' 'Theft']
subcategory | 8 | ['HTTP' 'TCP' 'UDP' 'Normal' 'OS_Fingerprint' 'Service_Scan'
 'Data_Exfiltration' 'Keylogging']

Handling categorical attributes (label encoding).
Objects: ['category', 'subcategory']

Dropping category and subcategory.
These are labels for other scenarios.

Splitting dataset (test/train): 0.2

Splitting dataset (validation/train): 0.25
X_train_df shape: (2201112, 37)
y_train_df shape: (2201112,)
X_val_df shape: (733705, 37)
y_val_df shape: (733705,)
X_test_df shape: (733705, 37)
y_test_df shape: (733705,)

Converting dataframe to numpy array.
X_train shape: (2201112, 37)
y_train shape: (2201112,)
X_val shape: (733705, 37)
y_val shape: (733705,)
X_test shape: (733705, 37)
y_test shape: (733705,)

Applying normalization.
1.4564101696014404 to normalize data.
7
(2201112, 7, 7, 1)
(733705, 7, 7, 1)
(733705, 7, 7, 1)
Model: "sequential_3"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_6 (Conv2D)            (None, 6, 6, 64)          320       
_________________________________________________________________
conv2d_7 (Conv2D)            (None, 5, 5, 64)          16448     
_________________________________________________________________
max_pooling2d_3 (MaxPooling2 (None, 2, 2, 64)          0         
_________________________________________________________________
flatten_3 (Flatten)          (None, 256)               0         
_________________________________________________________________
dropout_3 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_6 (Dense)              (None, 64)                16448     
_________________________________________________________________
dense_7 (Dense)              (None, 1)                 65        
=================================================================
Total params: 33,281
Trainable params: 33,281
Non-trainable params: 0
_________________________________________________________________

Fitting the network.
Epoch 1/10
441/441 - 144s - loss: 0.0180 - binary_accuracy: 0.9998 - precision_3: 0.9999 - val_precision_3: 0.9999 - val_binary_accuracy: 0.9999 - val_loss: 0.0017
Epoch 2/10
441/441 - 145s - loss: 7.7289e-04 - binary_accuracy: 0.9999 - precision_3: 0.9999 - val_precision_3: 0.9999 - val_binary_accuracy: 0.9999 - val_loss: 4.4666e-04
Epoch 3/10
441/441 - 145s - loss: 4.9948e-04 - binary_accuracy: 0.9999 - precision_3: 0.9999 - val_precision_3: 0.9999 - val_binary_accuracy: 0.9999 - val_loss: 4.8994e-04
Epoch 4/10
441/441 - 145s - loss: 2.1522e-04 - binary_accuracy: 0.9999 - precision_3: 1.0000 - val_precision_3: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 1.7505e-04
Epoch 5/10
441/441 - 145s - loss: 1.6438e-04 - binary_accuracy: 1.0000 - precision_3: 1.0000 - val_precision_3: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 8.9636e-05
Epoch 6/10
441/441 - 145s - loss: 1.5860e-04 - binary_accuracy: 1.0000 - precision_3: 1.0000 - val_precision_3: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 1.4449e-04
Epoch 7/10
441/441 - 145s - loss: 1.7019e-04 - binary_accuracy: 1.0000 - precision_3: 1.0000 - val_precision_3: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 9.7277e-05
Epoch 8/10
441/441 - 145s - loss: 1.1887e-04 - binary_accuracy: 1.0000 - precision_3: 1.0000 - val_precision_3: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 5.4442e-05
Epoch 9/10
441/441 - 144s - loss: 9.4716e-05 - binary_accuracy: 1.0000 - precision_3: 1.0000 - val_precision_3: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 7.4685e-05
Epoch 10/10
441/441 - 144s - loss: 9.7880e-05 - binary_accuracy: 1.0000 - precision_3: 1.0000 - val_precision_3: 1.0000 - val_binary_accuracy: 1.0000 - val_loss: 8.3738e-05
1449.7851004600525 s to train model.

Performance on VALIDATION set:
Confusion matrix:
[[733584     12]
 [     6    103]]
Accuracy: 0.9999754669792356
Precision: 0.9478219974787481
Recall: 0.9724688853315309
F1: 0.9598152943798537

Performance on TEST set:
Confusion matrix:
[[733592     15]
 [     5     93]]
Accuracy: 0.9999727410880395
Precision: 0.9305521476899291
Recall: 0.9744795724608486
F1: 0.9514494949948126
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_1.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_2.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_3.csv
Reading ../../../../datasets/bot-iot/UNSW_2018_IoT_Botnet_Full5pc_4.csv
<class 'pandas.core.frame.DataFrame'>
Int64Index: 3668522 entries, 1 to 3668522
Data columns (total 45 columns):
stime                               float64
flgs                                object
flgs_number                         int64
proto                               object
proto_number                        int64
saddr                               object
sport                               object
daddr                               object
dport                               object
pkts                                int64
bytes                               int64
state                               object
state_number                        int64
ltime                               float64
seq                                 int64
dur                                 float64
mean                                float64
stddev                              float64
sum                                 float64
min                                 float64
max                                 float64
spkts                               int64
dpkts                               int64
sbytes                              int64
dbytes                              int64
rate                                float64
srate                               float64
drate                               float64
TnBPSrcIP                           int64
TnBPDstIP                           int64
TnP_PSrcIP                          int64
TnP_PDstIP                          int64
TnP_PerProto                        int64
TnP_Per_Dport                       int64
AR_P_Proto_P_SrcIP                  float64
AR_P_Proto_P_DstIP                  float64
N_IN_Conn_P_DstIP                   int64
N_IN_Conn_P_SrcIP                   int64
AR_P_Proto_P_Sport                  float64
AR_P_Proto_P_Dport                  float64
Pkts_P_State_P_Protocol_P_DestIP    int64
Pkts_P_State_P_Protocol_P_SrcIP     int64
attack                              int64
category                            object
subcategory                         object
dtypes: float64(15), int64(21), object(9)
memory usage: 1.3+ GB

Dataframe contains NaN values: False
Number of NaN columns: 0
NaN columns: [] 


Attack types: [1 0]
Attack distribution:
1    3668045
0        477
Name: attack, dtype: int64

Cateogry types: ['DoS' 'DDoS' 'Normal' 'Reconnaissance' 'Theft']
Cateogry distribution:
DDoS              1926624
DoS               1650260
Reconnaissance      91082
Normal                477
Theft                  79
Name: category, dtype: int64

Subcategory types: ['HTTP' 'TCP' 'UDP' 'Normal' 'OS_Fingerprint' 'Service_Scan'
 'Data_Exfiltration' 'Keylogging']
Subcategory distribution:
UDP                  1981230
TCP                  1593180
Service_Scan           73168
OS_Fingerprint         17914
HTTP                    2474
Normal                   477
Keylogging                73
Data_Exfiltration          6
Name: subcategory, dtype: int64

Column | # of different values
stime | 392259
flgs | 9
flgs_number | 9
proto | 5
proto_number | 5
saddr | 21
sport | 65541
daddr | 84
dport | 7698
pkts | 123
bytes | 1633
state | 11
state_number | 11
ltime | 383624
seq | 262212
dur | 612509
mean | 507089
stddev | 421379
sum | 934972
min | 271147
max | 594525
spkts | 91
dpkts | 62
sbytes | 1052
dbytes | 472
rate | 139677
srate | 119709
drate | 20714
TnBPSrcIP | 8639
TnBPDstIP | 7631
TnP_PSrcIP | 1522
TnP_PDstIP | 1587
TnP_PerProto | 1560
TnP_Per_Dport | 1582
AR_P_Proto_P_SrcIP | 46289
AR_P_Proto_P_DstIP | 39186
N_IN_Conn_P_DstIP | 100
N_IN_Conn_P_SrcIP | 100
AR_P_Proto_P_Sport | 136207
AR_P_Proto_P_Dport | 42237
Pkts_P_State_P_Protocol_P_DestIP | 1595
Pkts_P_State_P_Protocol_P_SrcIP | 1526
attack | 2
category | 5
subcategory | 8

Removing attributes that have only one (or zero) sampled value.

Column | # of different values
stime | 392259
flgs | 9
flgs_number | 9
proto | 5
proto_number | 5
saddr | 21
sport | 65541
daddr | 84
dport | 7698
pkts | 123
bytes | 1633
state | 11
state_number | 11
ltime | 383624
seq | 262212
dur | 612509
mean | 507089
stddev | 421379
sum | 934972
min | 271147
max | 594525
spkts | 91
dpkts | 62
sbytes | 1052
dbytes | 472
rate | 139677
srate | 119709
drate | 20714
TnBPSrcIP | 8639
TnBPDstIP | 7631
TnP_PSrcIP | 1522
TnP_PDstIP | 1587
TnP_PerProto | 1560
TnP_Per_Dport | 1582
AR_P_Proto_P_SrcIP | 46289
AR_P_Proto_P_DstIP | 39186
N_IN_Conn_P_DstIP | 100
N_IN_Conn_P_SrcIP | 100
AR_P_Proto_P_Sport | 136207
AR_P_Proto_P_Dport | 42237
Pkts_P_State_P_Protocol_P_DestIP | 1595
Pkts_P_State_P_Protocol_P_SrcIP | 1526
attack | 2
category | 5
subcategory | 8

Removing redundant columns: ['state_number', 'proto_number', 'flgs_number']

Column | NaN values
stime                               0
flgs                                0
proto                               0
saddr                               0
sport                               0
daddr                               0
dport                               0
pkts                                0
bytes                               0
state                               0
ltime                               0
seq                                 0
dur                                 0
mean                                0
stddev                              0
sum                                 0
min                                 0
max                                 0
spkts                               0
dpkts                               0
sbytes                              0
dbytes                              0
rate                                0
srate                               0
drate                               0
TnBPSrcIP                           0
TnBPDstIP                           0
TnP_PSrcIP                          0
TnP_PDstIP                          0
TnP_PerProto                        0
TnP_Per_Dport                       0
AR_P_Proto_P_SrcIP                  0
AR_P_Proto_P_DstIP                  0
N_IN_Conn_P_DstIP                   0
N_IN_Conn_P_SrcIP                   0
AR_P_Proto_P_Sport                  0
AR_P_Proto_P_Dport                  0
Pkts_P_State_P_Protocol_P_DestIP    0
Pkts_P_State_P_Protocol_P_SrcIP     0
attack                              0
category                            0
subcategory                         0
dtype: int64
Removing attributes with more than half NaN values.
Dataframe contains NaN values: False

Column | NaN values (after dropping columns)
stime                               0
flgs                                0
proto                               0
saddr                               0
sport                               0
daddr                               0
dport                               0
pkts                                0
bytes                               0
state                               0
ltime                               0
seq                                 0
dur                                 0
mean                                0
stddev                              0
sum                                 0
min                                 0
max                                 0
spkts                               0
dpkts                               0
sbytes                              0
dbytes                              0
rate                                0
srate                               0
drate                               0
TnBPSrcIP                           0
TnBPDstIP                           0
TnP_PSrcIP                          0
TnP_PDstIP                          0
TnP_PerProto                        0
TnP_Per_Dport                       0
AR_P_Proto_P_SrcIP                  0
AR_P_Proto_P_DstIP                  0
N_IN_Conn_P_DstIP                   0
N_IN_Conn_P_SrcIP                   0
AR_P_Proto_P_Sport                  0
AR_P_Proto_P_Dport                  0
Pkts_P_State_P_Protocol_P_DestIP    0
Pkts_P_State_P_Protocol_P_SrcIP     0
attack                              0
category                            0
subcategory                         0
dtype: int64
stime unique values: 392259
flgs unique values: 9
proto unique values: 9
saddr unique values: 5
sport unique values: 5
daddr unique values: 21
dport unique values: 65541
pkts unique values: 84
bytes unique values: 7698
state unique values: 123
ltime unique values: 1633
seq unique values: 11
dur unique values: 11
mean unique values: 383624
stddev unique values: 262212
sum unique values: 612509
min unique values: 507089
max unique values: 421379
spkts unique values: 934972
dpkts unique values: 271147
sbytes unique values: 594525
dbytes unique values: 91
rate unique values: 62
srate unique values: 1052
drate unique values: 472
TnBPSrcIP unique values: 139677
TnBPDstIP unique values: 119709
TnP_PSrcIP unique values: 20714
TnP_PDstIP unique values: 8639
TnP_PerProto unique values: 7631
TnP_Per_Dport unique values: 1522
AR_P_Proto_P_SrcIP unique values: 1587
AR_P_Proto_P_DstIP unique values: 1560
N_IN_Conn_P_DstIP unique values: 1582
N_IN_Conn_P_SrcIP unique values: 46289
AR_P_Proto_P_Sport unique values: 39186
AR_P_Proto_P_Dport unique values: 100
Pkts_P_State_P_Protocol_P_DestIP unique values: 100
Pkts_P_State_P_Protocol_P_SrcIP unique values: 136207
attack unique values: 42237
category unique values: 1595
subcategory unique values: 1526
<class 'pandas.core.frame.DataFrame'>
Int64Index: 3668522 entries, 1 to 3668522
Columns: 42 entries, stime to subcategory
dtypes: float64(15), int64(18), object(9)
memory usage: 1.2+ GB

Objects: ['flgs', 'proto', 'saddr', 'sport', 'daddr', 'dport', 'state', 'category', 'subcategory'] 


Check for high cardinality.
Column | # of different values | values
flgs | 9 | ['e' 'e s' 'e d' 'e *' 'e g' 'eU' 'e &' 'e   t' 'e  D']
proto | 5 | ['tcp' 'arp' 'udp' 'icmp' 'ipv6-icmp']
saddr | 21 | ['192.168.100.147' '192.168.100.7' '192.168.100.148' '192.168.100.6'
 '192.168.100.149' '192.168.100.150' '192.168.100.5' '192.168.100.3'
 '192.168.100.1' '192.168.100.4' '192.168.100.27'
 'fe80::250:56ff:febe:254' '192.168.100.46' 'fe80::250:56ff:febe:26db'
 'fe80::250:56ff:febe:e9d9' 'fe80::c0c0:aa20:45b9:bdd9'
 'fe80::250:56ff:febe:89ee' 'fe80::2c6a:ff9b:7e14:166a'
 'fe80::250:56ff:febe:bf1a' 'fe80::250:56ff:febe:c038' '192.168.100.55']
sport | 65540 | ['49960' nan '49962' ... '0x0008' '0x000d' '0x0011']
daddr | 84 | ['192.168.100.7' '192.168.100.147' '192.168.100.6' '192.168.100.148'
 '192.168.100.5' '192.168.100.3' '192.168.100.149' '192.168.100.150'
 '192.168.100.4' '27.124.125.250' '192.168.100.1' '192.168.100.27'
 '192.168.217.2' '192.168.100.255' '8.8.8.8' 'ff02::1' '255.255.255.255'
 '13.55.154.73' '192.168.100.55' '184.85.248.65' '205.251.194.167'
 '192.5.5.241' '192.35.51.30' '205.251.195.97' '205.251.196.236'
 '199.7.91.13' '192.12.94.30' '52.35.35.13' '216.239.38.10' '199.7.83.42'
 '192.42.93.30' '172.217.25.170' 'ff02::fb' '224.0.0.251' 'ff02::2'
 '129.250.35.250' '91.189.91.157' '216.239.34.10' '192.52.178.30'
 '224.0.0.252' '96.7.49.66' '205.251.193.2' '192.33.4.12' '192.41.162.30'
 '192.36.148.17' '35.165.2.252' '52.11.124.117' '52.201.147.106'
 '216.239.36.10' '192.112.36.4' '192.31.80.30' '91.189.92.40'
 '128.63.2.53' '202.12.27.33' '192.203.230.10' '192.55.83.30'
 '205.251.198.119' '192.33.14.30' '192.58.128.30' '205.251.196.160'
 '205.251.199.148' '192.54.112.30' '156.154.100.3' '199.19.57.1'
 '205.251.194.86' '205.251.199.194' '205.251.199.61' '205.251.195.185'
 '205.251.194.201' '205.251.198.239' '205.251.193.205' '205.251.196.32'
 '198.41.0.4' '192.48.79.30' '199.19.56.1' '156.154.101.3'
 '205.251.197.206' '205.251.192.170' '205.251.195.59' '205.251.198.91'
 '205.251.194.84' '192.26.92.30' '205.251.194.102' '205.251.194.154']
dport | 7697 | ['80' nan '30551' ... '42052' '2660' '2664']
state | 11 | ['RST' 'CON' 'REQ' 'INT' 'URP' 'FIN' 'ACC' 'NRS' 'ECO' 'TST' 'MAS']
category | 5 | ['DoS' 'DDoS' 'Normal' 'Reconnaissance' 'Theft']
subcategory | 8 | ['HTTP' 'TCP' 'UDP' 'Normal' 'OS_Fingerprint' 'Service_Scan'
 'Data_Exfiltration' 'Keylogging']

Handling categorical attributes (label encoding).
Objects: ['category', 'subcategory']

Dropping category and subcategory.
These are labels for other scenarios.

Splitting dataset (test/train): 0.2

Splitting dataset (validation/train): 0.25
X_train_df shape: (2201112, 37)
y_train_df shape: (2201112,)
X_val_df shape: (733705, 37)
y_val_df shape: (733705,)
X_test_df shape: (733705, 37)
y_test_df shape: (733705,)

Converting dataframe to numpy array.
X_train shape: (2201112, 37)
y_train shape: (2201112,)
X_val shape: (733705, 37)
y_val shape: (733705,)
X_test shape: (733705, 37)
y_test shape: (733705,)

Applying normalization.
1.3690447807312012 to normalize data.
7
(2201112, 7, 7, 1)
(733705, 7, 7, 1)
(733705, 7, 7, 1)
Model: "sequential_4"
_________________________________________________________________
Layer (type)                 Output Shape              Param #   
=================================================================
conv2d_8 (Conv2D)            (None, 6, 6, 64)          320       
_________________________________________________________________
conv2d_9 (Conv2D)            (None, 5, 5, 64)          16448     
_________________________________________________________________
max_pooling2d_4 (MaxPooling2 (None, 2, 2, 64)          0         
_________________________________________________________________
flatten_4 (Flatten)          (None, 256)               0         
_________________________________________________________________
dropout_4 (Dropout)          (None, 256)               0         
_________________________________________________________________
dense_8 (Dense)              (None, 64)                16448     
_________________________________________________________________
dense_9 (Dense)              (None, 1)                 65        
=================================================================
Total params: 33,281
Trainable params: 33,281
Non-trainable params: 0
_________________________________________________________________

Fitting the network.
Epoch 1/10
441/441 - 144s - loss: 0.0200 - precision_4: 0.9999 - binary_accuracy: 0.9979 - val_binary_accuracy: 0.9999 - val_precision_4: 0.9999 - val_loss: 0.0026
Epoch 2/10
441/441 - 144s - loss: 0.0011 - precision_4: 0.9999 - binary_accuracy: 0.9999 - val_binary_accuracy: 0.9999 - val_precision_4: 0.9999 - val_loss: 4.1232e-04
Epoch 3/10
441/441 - 144s - loss: 2.5932e-04 - precision_4: 0.9999 - binary_accuracy: 0.9999 - val_binary_accuracy: 1.0000 - val_precision_4: 1.0000 - val_loss: 1.0889e-04
Epoch 4/10
441/441 - 145s - loss: 2.9101e-04 - precision_4: 1.0000 - binary_accuracy: 0.9999 - val_binary_accuracy: 0.9999 - val_precision_4: 1.0000 - val_loss: 1.4526e-04
Epoch 5/10
441/441 - 144s - loss: 1.7119e-04 - precision_4: 1.0000 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_4: 1.0000 - val_loss: 1.1027e-04
Epoch 6/10
441/441 - 144s - loss: 1.2885e-04 - precision_4: 1.0000 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_4: 1.0000 - val_loss: 1.0519e-04
Epoch 7/10
441/441 - 144s - loss: 8.6836e-05 - precision_4: 1.0000 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_4: 1.0000 - val_loss: 7.0060e-05
Epoch 8/10
441/441 - 145s - loss: 1.1454e-04 - precision_4: 1.0000 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_4: 1.0000 - val_loss: 6.1017e-05
Epoch 9/10
441/441 - 144s - loss: 7.8700e-05 - precision_4: 1.0000 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_4: 1.0000 - val_loss: 6.4386e-05
Epoch 10/10
441/441 - 144s - loss: 1.0735e-04 - precision_4: 1.0000 - binary_accuracy: 1.0000 - val_binary_accuracy: 1.0000 - val_precision_4: 1.0000 - val_loss: 6.5781e-05
Using TensorFlow backend.
1447.7497580051422 s to train model.

Performance on VALIDATION set:
Confusion matrix:
[[733579     15]
 [     8    103]]
Accuracy: 0.9999686522512454
Precision: 0.9364352253067716
Recall: 0.9639537403252756
F1: 0.9497738212282557

Performance on TEST set:
Confusion matrix:
[[733594     18]
 [     3     90]]
Accuracy: 0.9999713781424414
Precision: 0.9166646219472908
Recall: 0.9838586996765276
F1: 0.9477540375851997
